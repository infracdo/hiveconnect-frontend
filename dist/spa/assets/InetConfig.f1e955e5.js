import{c as se,h as q,Q as $,f as S}from"./QBtn.e795bac4.js";import{Q as v,a as te}from"./QInput.e9968937.js";import{Q as oe}from"./QTable.0787f115.js";import{Q as K,a as D,b as ne,c as x}from"./QPage.6c2f9e53.js";import{Y as ie,c as R,h as U,g as re,_ as W,D as O,Z as j,r as m,B as H,$ as P,E as Q,F as T,G as r,H as l,R as M,a0 as A,J as y,K as I,a1 as J,a2 as Y,a3 as de,a4 as ue}from"./index.f7821c4e.js";import{Q as Z,a as B,b as E,c as z}from"./QCard.6caf12f0.js";import{a as ce,d as me}from"./QItem.10579f9e.js";import{a as N}from"./axios.a596eead.js";import{u as pe,e as be,g as fe,a as F,b as ve}from"./networkAddressAPIs.caec8974.js";import{g as ge}from"./rougeDevicesApi.52d00dcd.js";import"./QList.22941043.js";const X=ie("subsciber",{state:()=>({subscriberDetail:{subscriber_name:"",serial_number:"",acc_no:"",package_type:"",ssid:"",password:"",mode:"",olt_ip:"",olt_interface:""},modalIsOpen:!1,subscribercolumns:[{name:"id",label:"ID",field:"id",align:"left",sortable:!0},{name:"accountNumber",label:"Account No.",field:"accountNumber",align:"left",sortable:!0},{name:"clientName",label:"Client Name",field:"clientName",align:"left",sortable:!0},{name:"ipAssigned",label:"IP Assigned",field:"ipAssigned",align:"left",sortable:!0},{name:"onuSerialNumber",label:"ONU Serial Number",field:"onuSerialNumber",align:"left",sortable:!0},{name:"onuMacAddress",label:"ONU Mac Address",field:"onuMacAddress",align:"left",sortable:!0},{name:"oltIp",label:"OLT IP",field:"oltIp",align:"left",sortable:!0},{name:"packageTypeId",label:"Package Type ID",field:"packageTypeId",align:"left",sortable:!0},{name:"actions",label:"Actions",field:"",align:"left"}]})});var ee=se({name:"QBanner",props:{...ce,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(c,{slots:u}){const{proxy:{$q:d}}=re(),g=me(c,d),_=R(()=>"q-banner row items-center"+(c.dense===!0?" q-banner--dense":"")+(g.value===!0?" q-banner--dark q-dark":"")+(c.rounded===!0?" rounded-borders":"")),b=R(()=>`q-banner__actions row items-center justify-end col-${c.inlineActions===!0?"auto":"all"}`);return()=>{const e=[U("div",{class:"q-banner__avatar col-auto row items-center self-start"},q(u.avatar)),U("div",{class:"q-banner__content col text-body2"},q(u.default))],p=q(u.action);return p!==void 0&&e.push(U("div",{class:b.value},p)),U("div",{class:_.value+(c.inlineActions===!1&&p!==void 0?" q-banner--top-padding":""),role:"alert"},e)}}});const k=c=>(J("data-v-704e4894"),c=c(),Y(),c),_e={class:""},we={class:""},Ve={class:"q-gutter-sm"},Ae=k(()=>A("br",null,null,-1)),Ne=k(()=>A("br",null,null,-1)),ye=k(()=>A("br",null,null,-1)),Ie=k(()=>A("br",null,null,-1)),Me=k(()=>A("br",null,null,-1)),Se="http://127.0.0.1:8000",L="http://172.91.0.136:7547",G="http://172.91.10.108:8080",Ce=O({__name:"SubscriberModal",props:["dataId","getSubsribers"],setup(c){const u=c;N.defaults.timeout=0;const d=X(),{dataId:g}=j(u),_=m(""),b=m(""),e=m(""),p=m(""),w=m(""),V=m(""),n=m(""),s=m(""),t=m(""),f=m(!0),o=H({subscriber:"",configureSsid:"",setBandwidth:"",runAnsible:"",wanConfig:""});P(()=>{_.value=d.$state.subscriberDetail.acc_no,b.value=d.$state.subscriberDetail.subscriber_name,e.value=d.$state.subscriberDetail.package_type,p.value=d.$state.subscriberDetail.serial_number,w.value=d.$state.subscriberDetail.olt_ip,V.value=d.$state.subscriberDetail.olt_interface,n.value=d.$state.subscriberDetail.mode,s.value=d.$state.subscriberDetail.ssid,t.value=d.$state.subscriberDetail.password});const C=["0/1:1","0/1:2","0/1:3","0/2:1","0/2:2","0/2:3","0/3:1","0/3:2","0/3:3"],ae=()=>{d.$state.modalIsOpen=!d.$state.modalIsOpen},le=async h=>{await N.put(`${Se}/api/subscriber_test/${h}/edit`,{acc_no:_.value,subscriber_name:b.value,serial_number:p.value,olt_ip:w.value,olt_interface:V.value,package_type:e.value,mode:n.value,ssid:s.value,password:t.value}).then(a=>{o.subscriber=a.data,u.getSubsribers()}).catch(a=>{o.subscriber=a}),await N.post(`${L}/configureSSID`,{SN:p.value,NewSSID:n.value==="Bridged"?"":s.value,Password:t.value}).then(a=>{o.configureSsid=a.data}).catch(a=>{o.configureSsid=a}),await N.post(`${L}/bridgedWanConfig`,{SN:p.value}).then(a=>{o.wanConfig=a.data}).catch(a=>{o.wanConfig=a}),await N.post(G+"/setBandwidth").then(a=>{if(a.data)o.setBandwidth="Bandwidth Config Success!";else throw new Error("Something went wrong!")}).catch(a=>{o.setBandwidth=a}),await N.post(G+"/runPlaybook").then(a=>{if(a.data)o.runAnsible="Successfull Setup!";else throw new Error("Something went wrong!")}).catch(a=>{o.runAnsible=a})};return(h,a)=>(Q(),T(x,null,{default:r(()=>[l(K,{modelValue:M(d).$state.modalIsOpen,"onUpdate:modelValue":a[12]||(a[12]=i=>M(d).$state.modalIsOpen=i),modelModifiers:{trim:!0}},{default:r(()=>[l(Z,null,{default:r(()=>[l(B,{class:"flex-subscriber"},{default:r(()=>[A("div",_e,[l(v,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=i=>_.value=i),modelModifiers:{trim:!0},outlined:"",label:"Account No.",class:"q-ma-md",disable:""},null,8,["modelValue"]),l(v,{modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=i=>b.value=i),modelModifiers:{trim:!0},outlined:"",label:"Subscriber Name",class:"q-ma-md",disable:""},null,8,["modelValue"]),l(v,{modelValue:e.value,"onUpdate:modelValue":a[2]||(a[2]=i=>e.value=i),modelModifiers:{trim:!0},outlined:"",label:"Package Type",class:"q-ma-md",disable:""},null,8,["modelValue"]),l(v,{modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=i=>p.value=i),modelModifiers:{trim:!0},outlined:"",label:"Serial Number",class:"q-ma-md"},null,8,["modelValue"]),l(D,{modelValue:w.value,"onUpdate:modelValue":a[4]||(a[4]=i=>w.value=i),modelModifiers:{trim:!0},filled:"",options:["172.16.0.2","172.16.0.58","172.16.0.22"],label:"OLT IP",class:"q-ma-md"},null,8,["modelValue"])]),A("div",we,[l(D,{modelValue:V.value,"onUpdate:modelValue":a[5]||(a[5]=i=>V.value=i),modelModifiers:{trim:!0},filled:"",options:C,label:"OLT Interface",class:"q-ma-md"},null,8,["modelValue"]),l(ne,{filled:"",label:"Mode","stack-label":"",class:"q-ma-md"},{control:r(()=>[A("div",Ve,[l(E,{modelValue:n.value,"onUpdate:modelValue":a[6]||(a[6]=i=>n.value=i),modelModifiers:{trim:!0},dense:"",val:"Bridged",label:"Bridged"},null,8,["modelValue"]),l(E,{modelValue:n.value,"onUpdate:modelValue":a[7]||(a[7]=i=>n.value=i),modelModifiers:{trim:!0},dense:"",val:"Routed",label:"Routed"},null,8,["modelValue"])])]),_:1}),l(v,{modelValue:s.value,"onUpdate:modelValue":a[8]||(a[8]=i=>s.value=i),modelModifiers:{trim:!0},outlined:"",class:"q-ma-md",label:"SSID"},null,8,["modelValue"]),l(v,{modelValue:t.value,"onUpdate:modelValue":a[10]||(a[10]=i=>t.value=i),modelModifiers:{trim:!0},outlined:"",class:"q-ma-md",label:"Password",type:f.value?"password":"text"},{append:r(()=>[l($,{name:f.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[9]||(a[9]=i=>f.value=!f.value)},null,8,["name"])]),_:1},8,["modelValue","type"])])]),_:1}),l(z,{align:"left"},{default:r(()=>[l(S,{flat:"",label:"Update Info",color:"secondary",onClick:a[11]||(a[11]=i=>le(M(g)))}),l(S,{flat:"",label:"Close",color:"primary",onClick:ae})]),_:1}),l(ee,{class:"bg-primary text-white"},{default:r(()=>[y(" Subscriber Details: "+I(o.subscriber)+" ",1),Ae,y(" SSID/Password Config: "+I(o.configureSsid)+" ",1),Ne,y(" Wan Config: "+I(o.wanConfig)+" ",1),ye,y(" Bandwidth: "+I(o.setBandwidth)+" ",1),Ie,y(" Playbook: "+I(o.runAnsible)+" ",1),Me]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});var ke=W(Ce,[["__scopeId","data-v-704e4894"]]);const Ue=c=>(J("data-v-093bb9c2"),c=c(),Y(),c),$e=Ue(()=>A("div",{class:"text-h6"},"For Provisioning",-1)),De=O({__name:"AddNewClient",props:{isOpen:{type:Boolean},serialAndMac:{},client:{},closeModal:{type:Function}},setup(c){const u=c,{isOpen:d}=j(u),g=()=>{u.closeModal()},_=[{label:"Gusa 1",value:"172.16.0.2"},{label:"Gusa 2",value:"172.16.0.10"}],b=m("");m();const e=H({clientId:0,accountNumber:"",packageType:"",serialAndMac:{serialNum:{label:"",idx:0},macAddress:""},oltIp:"",ipAssign:"",clientName:""});de(()=>{var n,s;e.serialAndMac.serialNum.label=(n=u.client)==null?void 0:n.onuSerialNumber,e.serialAndMac.macAddress=(s=u.client)==null?void 0:s.onuMacAddress}),P(()=>{var n,s,t,f,o,C;e.clientId=(n=u.client)==null?void 0:n.id,e.accountNumber=(s=u.client)==null?void 0:s.accountNumber,e.clientName=(t=u.client)==null?void 0:t.clientName,e.ipAssign=(f=u.client)==null?void 0:f.ipAssigned,e.oltIp=(o=u.client)==null?void 0:o.oltIp,e.packageType=(C=u.client)==null?void 0:C.packageTypeId});const p=async()=>{console.log(e);try{await pe(e.clientId,e.ipAssign,e.serialAndMac.serialNum.label,e.oltIp,e.serialAndMac.macAddress)&&(b.value="Successfull Client Update!")}catch(n){b.value="Unsuccessful client Update: "+n}try{const n=await be(e.accountNumber,e.clientName,e.serialAndMac.serialNum.label,e.serialAndMac.macAddress,e.ipAssign,e.oltIp,e.packageType);b.value=n}catch{throw new Error("Provoision Not complete")}},w=async()=>{const[n]=await fe(),{ipAddress:s}=n;e.ipAssign=s},V=async()=>{e.serialAndMac.macAddress=u.serialAndMac[e.serialAndMac.serialNum.idx].mac_address};return(n,s)=>(Q(),T(x,null,{default:r(()=>[l(K,{modelValue:M(d),"onUpdate:modelValue":s[7]||(s[7]=t=>ue(d)?d.value=t:null),persistent:""},{default:r(()=>[l(Z,null,{default:r(()=>[l(B,null,{default:r(()=>[$e]),_:1}),l(B,{class:"q-pt-none flex-client"},{default:r(()=>[l(v,{modelValue:e.accountNumber,"onUpdate:modelValue":s[0]||(s[0]=t=>e.accountNumber=t),filled:"",label:"Account Number",readonly:""},null,8,["modelValue"]),l(v,{modelValue:e.clientName,"onUpdate:modelValue":s[1]||(s[1]=t=>e.clientName=t),filled:"",label:"Client Name",readonly:""},null,8,["modelValue"]),l(v,{modelValue:e.ipAssign,"onUpdate:modelValue":s[2]||(s[2]=t=>e.ipAssign=t),filled:"",label:"IP Assign",readonly:""},{append:r(()=>[l($,{name:"add",class:"cursor-pointer",onClick:w})]),_:1},8,["modelValue"]),l(v,{modelValue:e.packageType,"onUpdate:modelValue":s[3]||(s[3]=t=>e.packageType=t),filled:"",label:"Package Type",readonly:""},null,8,["modelValue"]),l(D,{outlined:"",modelValue:e.serialAndMac.serialNum,"onUpdate:modelValue":s[4]||(s[4]=t=>e.serialAndMac.serialNum=t),options:n.serialAndMac.map((t,f)=>({label:t.serial_number,idx:f})),label:"ONU Seriual Number"},null,8,["modelValue","options"]),l(v,{modelValue:e.serialAndMac.macAddress,"onUpdate:modelValue":s[5]||(s[5]=t=>e.serialAndMac.macAddress=t),filled:"",label:"ONU Mac Address",readonly:""},{append:r(()=>[l($,{name:"add",class:"cursor-pointer",onClick:V})]),_:1},8,["modelValue"]),l(D,{outlined:"",modelValue:e.oltIp,"onUpdate:modelValue":s[6]||(s[6]=t=>e.oltIp=t),options:_,label:"OLT","emit-value":"","map-options":""},null,8,["modelValue"]),l(z,{align:"right"},{default:r(()=>[l(S,{flat:"",label:"OK",color:"primary",onClick:p}),l(S,{flat:"",label:"close",color:"primary",onClick:g})]),_:1})]),_:1}),l(ee,{class:"bg-primary text-white"},{default:r(()=>[y(" Response: "+I(b.value),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});var qe=W(De,[["__scopeId","data-v-093bb9c2"]]);const Ge=O({__name:"InetConfig",setup(c){const u=X(),d=m(),g=m([]),_=m(""),b=u.$state.subscribercolumns,e=m(!1);let p=[];const w=m(),V=async t=>{e.value=!e.value,p=(await ge()).map(o=>({serial_number:o.serial_number,mac_address:o.mac_address})),w.value=await ve(t)},n=()=>{e.value=!e.value},s=async()=>{g.value=[],g.value=await F()};return P(async()=>{g.value=await F()}),(t,f)=>(Q(),T(x,{padding:""},{default:r(()=>[l(oe,{rows:g.value,title:"For Provision","row-key":"name",columns:M(b),loading:!(g.value.length>0),pagination:{rowsPerPage:10},dense:t.$q.screen.lt.md},{"body-cell-actions":r(o=>[l(te,{props:o},{default:r(()=>[l(S,{dense:"",round:"",flat:"",icon:"assignment",onClick:C=>V(o.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),"top-right":r(()=>[l(S,{icon:"autorenew",class:"cursor-pointer q-mx-sm",onClick:s,flat:""}),l(v,{modelValue:_.value,"onUpdate:modelValue":f[0]||(f[0]=o=>_.value=o),filled:"",dense:"",label:"Search",debounce:"300",color:"primary"},{append:r(()=>[l($,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","loading","dense"]),l(qe,{"is-open":e.value,onOpenModal:V,"serial-and-mac":M(p),client:w.value,"close-modal":n},null,8,["is-open","serial-and-mac","client"]),l(ke,{"data-id":d.value,"get-subsribers":s},null,8,["data-id"])]),_:1}))}});export{Ge as default};
