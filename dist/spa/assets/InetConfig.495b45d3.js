import{g as h,Q as E}from"./QBtn.3ba6f25b.js";import{Q as S,a as fe}from"./QInput.5fe3a7b8.js";import{Q as ge}from"./QTable.a08f88af.js";import{Q as j,a as $,b as L,c as _e}from"./QPage.82fa872d.js";import{a1 as Ne,_ as F,J as q,r as c,a2 as R,H as B,w as we,K as P,L as x,M as s,N as e,X as T,a3 as ee,a4 as d,P as A,Q as b,a5 as W,O as Ie,a6 as H,a7 as le,a8 as ae,a9 as ye}from"./index.40ce7caf.js";import{Q as Se,a as O}from"./QBanner.a12b0268.js";import{Q as U,a as D}from"./QCard.ce0ae417.js";import{Q as z,a as J}from"./QRadio.3781c097.js";import{a as k}from"./axios.a596eead.js";import{g as te,c as Ve,a as Ae,b as Me,u as Ce,e as ke,d as he,f as X}from"./networkAddressAPIs.0b423979.js";import{g as Te}from"./rougeDevicesApi.2de284de.js";import"./QItem.be07e990.js";import"./QList.5b2d3ea8.js";const se=Ne("subsciber",{state:()=>({subscriberDetail:{subscriber_name:"",serial_number:"",acc_no:"",package_type:"",ssid:"",password:"",mode:"",olt_ip:"",olt_interface:""},modalIsOpen:!1,subscribercolumns:[{name:"id",label:"ID",field:"id",align:"left",sortable:!0},{name:"accountNumber",label:"Account No.",field:"accountNumber",align:"left",sortable:!0},{name:"clientName",label:"Client Name",field:"clientName",align:"left",sortable:!0},{name:"ipAssigned",label:"IP Assigned",field:"ipAssigned",align:"left",sortable:!0},{name:"onuSerialNumber",label:"ONU Serial Number",field:"onuSerialNumber",align:"left",sortable:!0},{name:"onuMacAddress",label:"ONU Mac Address",field:"onuMacAddress",align:"left",sortable:!0},{name:"oltIp",label:"OLT IP",field:"oltIp",align:"left",sortable:!0},{name:"packageTypeId",label:"Package Type ID",field:"packageTypeId",align:"left",sortable:!0},{name:"actions",label:"Actions",field:"",align:"left"}]})});const Ue={class:"provision-info"},De=["src"],Oe=q({__name:"TroubleshootClient",props:{confirm:{type:Boolean},closeModal:{type:Function},deviceName:{},clientId:{}},setup(N){const p=N,m=c(!1),{confirm:f}=R(p),V=()=>{p.closeModal()},g=c({__name__:"",device_name:"",device_role:"",instance:"",job:"",site_name:"",site_status:"",site_tenant:""}),a=c("2d"),v=c(""),w=c(""),o=B({accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuMacAddress:"",onuDeviceName:"",packageTypeId:"",oltSite:"",oltInterface:""}),n=B({upStream:"",downStream:""}),t=c(),i=[{label:"Last 5 minutes",value:"5m"},{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 3 hours",value:"3h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 2 days",value:"2d"},{label:"Last 90 days",value:"90d"}],I=async(r,y)=>{const _=t.value;_==null||_.start();const M=await k.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${r}"}`);g.value=M.data.data.result[0].metric,v.value=M.data.data.result[0].value[1];const C=await k.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${g.value.site_name}"}`);w.value=C.data.data.result[0].value[1];const l=await te(y),{accountNumber:u,clientName:oe,ipAssigned:ne,oltIp:G,onuDeviceName:ie,onuMacAddress:ue,onuSerialNumber:re,packageTypeId:K}=l;o.accountNumber=u,o.clientName=oe,o.ipAssigned=ne,o.oltIp=G,o.onuDeviceName=ie,o.onuMacAddress=ue,o.onuSerialNumber=re,o.packageTypeId=K;const de=await Ve(G),{olt_site:ce}=de;o.oltSite=ce;const me=await Ae(K),{upstream:pe,downstream:be}=me;n.upStream=pe,n.downStream=be;const ve=await Me(r);o.oltInterface=ve,_==null||_.stop(),m.value=!0};return we(f,r=>{f.value===!0&&I(p.deviceName,p.clientId)}),(r,y)=>(P(),x(L,null,{default:s(()=>[e(Se,{ref_key:"bar",ref:t,color:"info",position:"bottom",size:"10px","skip-hijack":""},null,512),e(j,{modelValue:T(f),"onUpdate:modelValue":y[1]||(y[1]=_=>ee(f)?f.value=_:null),persistent:""},{default:s(()=>[m.value?(P(),x(U,{key:0,class:"hehe"},{default:s(()=>[d("div",Ue,[e(U,null,{default:s(()=>[e(O,{class:"bg-primary text-white"},{default:s(()=>[A(" Client Details ")]),_:1}),e(D,null,{default:s(()=>[d("p",null,"Client Name: "+b(o.clientName),1),d("p",null,"Account Number: "+b(o.accountNumber),1),d("p",null,"Package Type: "+b(o.packageTypeId),1)]),_:1})]),_:1}),e(U,null,{default:s(()=>[e(O,{class:"bg-primary text-white"},{default:s(()=>[A(" ONU Details ")]),_:1}),e(D,null,{default:s(()=>[d("p",null,[A(" ONU Status: "),d("span",{style:W(v.value==="1"?"color: green":"color: red")},b(v.value==="1"?"UP":"Down"),5)]),d("p",null,b(g.value.instance),1),d("p",null,"ONU Serial Number: "+b(o.onuSerialNumber),1),d("p",null,"ONU Mac Address: "+b(o.onuMacAddress),1),d("p",null," upstream: "+b(n.upStream)+" downstream: "+b(n.downStream),1)]),_:1})]),_:1}),e(U,null,{default:s(()=>[e(O,{class:"bg-primary text-white"},{default:s(()=>[A(" OLT Details ")]),_:1}),e(D,null,{default:s(()=>[d("p",null,[A(" OLT Status: "),d("span",{style:W(w.value==="1"?"color: green":"color: red")},b(w.value==="1"?"UP":"Down"),5)]),d("p",null," OLT IP: "+b(o.oltIp),1),d("p",null,"OLT Site: "+b(o.oltSite),1),d("p",null,"OLT Interface: "+b(o.oltInterface),1)]),_:1})]),_:1})]),e($,{modelValue:a.value,"onUpdate:modelValue":y[0]||(y[0]=_=>a.value=_),options:i,label:"Select Time",filled:"",class:"select-time q-py-md","emit-value":"","map-options":""},null,8,["modelValue"]),d("iframe",{src:`http://172.91.10.151:3000/d-solo/d94d1e0e-a6e4-45c4-847f-6603e1c31ccb/subscribers-traffic-rate-and-uptime?orgId=1&from=now-${a.value}&to=now&var-Subscriber=${r.deviceName}&panelId=3`,class:"grafana-panel",frameborder:"0"},null,8,De),e(z,{vertical:"",align:"right"},{default:s(()=>[e(h,{filled:"",label:"Close",color:"red",onClick:V})]),_:1})]),_:1})):Ie("",!0)]),_:1},8,["modelValue"])]),_:1}))}});var $e=F(Oe,[["__scopeId","data-v-60aab081"]]);const Q=N=>(le("data-v-7a47d3e6"),N=N(),ae(),N),Pe={class:""},xe={class:""},Qe={class:"q-gutter-sm"},Be=Q(()=>d("br",null,null,-1)),Le=Q(()=>d("br",null,null,-1)),qe=Q(()=>d("br",null,null,-1)),Ee=Q(()=>d("br",null,null,-1)),je=Q(()=>d("br",null,null,-1)),Fe="http://127.0.0.1:8000",Y="http://172.91.0.136:7547",Z="http://172.91.10.108:8080",Re=q({__name:"SubscriberModal",props:["dataId","getSubsribers"],setup(N){const p=N;k.defaults.timeout=0;const m=se(),{dataId:f}=R(p),V=c(""),g=c(""),a=c(""),v=c(""),w=c(""),o=c(""),n=c(""),t=c(""),i=c(""),I=c(!0),r=B({subscriber:"",configureSsid:"",setBandwidth:"",runAnsible:"",wanConfig:""});H(()=>{V.value=m.$state.subscriberDetail.acc_no,g.value=m.$state.subscriberDetail.subscriber_name,a.value=m.$state.subscriberDetail.package_type,v.value=m.$state.subscriberDetail.serial_number,w.value=m.$state.subscriberDetail.olt_ip,o.value=m.$state.subscriberDetail.olt_interface,n.value=m.$state.subscriberDetail.mode,t.value=m.$state.subscriberDetail.ssid,i.value=m.$state.subscriberDetail.password});const y=["0/1:1","0/1:2","0/1:3","0/2:1","0/2:2","0/2:3","0/3:1","0/3:2","0/3:3"],_=()=>{m.$state.modalIsOpen=!m.$state.modalIsOpen},M=async C=>{await k.put(`${Fe}/api/subscriber_test/${C}/edit`,{acc_no:V.value,subscriber_name:g.value,serial_number:v.value,olt_ip:w.value,olt_interface:o.value,package_type:a.value,mode:n.value,ssid:t.value,password:i.value}).then(l=>{r.subscriber=l.data,p.getSubsribers()}).catch(l=>{r.subscriber=l}),await k.post(`${Y}/configureSSID`,{SN:v.value,NewSSID:n.value==="Bridged"?"":t.value,Password:i.value}).then(l=>{r.configureSsid=l.data}).catch(l=>{r.configureSsid=l}),await k.post(`${Y}/bridgedWanConfig`,{SN:v.value}).then(l=>{r.wanConfig=l.data}).catch(l=>{r.wanConfig=l}),await k.post(Z+"/setBandwidth").then(l=>{if(l.data)r.setBandwidth="Bandwidth Config Success!";else throw new Error("Something went wrong!")}).catch(l=>{r.setBandwidth=l}),await k.post(Z+"/runPlaybook").then(l=>{if(l.data)r.runAnsible="Successfull Setup!";else throw new Error("Something went wrong!")}).catch(l=>{r.runAnsible=l})};return(C,l)=>(P(),x(L,null,{default:s(()=>[e(j,{modelValue:T(m).$state.modalIsOpen,"onUpdate:modelValue":l[12]||(l[12]=u=>T(m).$state.modalIsOpen=u),modelModifiers:{trim:!0}},{default:s(()=>[e(U,null,{default:s(()=>[e(D,{class:"flex-subscriber"},{default:s(()=>[d("div",Pe,[e(S,{modelValue:V.value,"onUpdate:modelValue":l[0]||(l[0]=u=>V.value=u),modelModifiers:{trim:!0},outlined:"",label:"Account No.",class:"q-ma-md",disable:""},null,8,["modelValue"]),e(S,{modelValue:g.value,"onUpdate:modelValue":l[1]||(l[1]=u=>g.value=u),modelModifiers:{trim:!0},outlined:"",label:"Subscriber Name",class:"q-ma-md",disable:""},null,8,["modelValue"]),e(S,{modelValue:a.value,"onUpdate:modelValue":l[2]||(l[2]=u=>a.value=u),modelModifiers:{trim:!0},outlined:"",label:"Package Type",class:"q-ma-md",disable:""},null,8,["modelValue"]),e(S,{modelValue:v.value,"onUpdate:modelValue":l[3]||(l[3]=u=>v.value=u),modelModifiers:{trim:!0},outlined:"",label:"Serial Number",class:"q-ma-md"},null,8,["modelValue"]),e($,{modelValue:w.value,"onUpdate:modelValue":l[4]||(l[4]=u=>w.value=u),modelModifiers:{trim:!0},filled:"",options:["172.16.0.2","172.16.0.58","172.16.0.22"],label:"OLT IP",class:"q-ma-md"},null,8,["modelValue"])]),d("div",xe,[e($,{modelValue:o.value,"onUpdate:modelValue":l[5]||(l[5]=u=>o.value=u),modelModifiers:{trim:!0},filled:"",options:y,label:"OLT Interface",class:"q-ma-md"},null,8,["modelValue"]),e(_e,{filled:"",label:"Mode","stack-label":"",class:"q-ma-md"},{control:s(()=>[d("div",Qe,[e(J,{modelValue:n.value,"onUpdate:modelValue":l[6]||(l[6]=u=>n.value=u),modelModifiers:{trim:!0},dense:"",val:"Bridged",label:"Bridged"},null,8,["modelValue"]),e(J,{modelValue:n.value,"onUpdate:modelValue":l[7]||(l[7]=u=>n.value=u),modelModifiers:{trim:!0},dense:"",val:"Routed",label:"Routed"},null,8,["modelValue"])])]),_:1}),e(S,{modelValue:t.value,"onUpdate:modelValue":l[8]||(l[8]=u=>t.value=u),modelModifiers:{trim:!0},outlined:"",class:"q-ma-md",label:"SSID"},null,8,["modelValue"]),e(S,{modelValue:i.value,"onUpdate:modelValue":l[10]||(l[10]=u=>i.value=u),modelModifiers:{trim:!0},outlined:"",class:"q-ma-md",label:"Password",type:I.value?"password":"text"},{append:s(()=>[e(E,{name:I.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:l[9]||(l[9]=u=>I.value=!I.value)},null,8,["name"])]),_:1},8,["modelValue","type"])])]),_:1}),e(z,{align:"left"},{default:s(()=>[e(h,{flat:"",label:"Update Info",color:"secondary",onClick:l[11]||(l[11]=u=>M(T(f)))}),e(h,{flat:"",label:"Close",color:"primary",onClick:_})]),_:1}),e(O,{class:"bg-primary text-white"},{default:s(()=>[A(" Subscriber Details: "+b(r.subscriber)+" ",1),Be,A(" SSID/Password Config: "+b(r.configureSsid)+" ",1),Le,A(" Wan Config: "+b(r.wanConfig)+" ",1),qe,A(" Bandwidth: "+b(r.setBandwidth)+" ",1),Ee,A(" Playbook: "+b(r.runAnsible)+" ",1),je]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});var He=F(Re,[["__scopeId","data-v-7a47d3e6"]]);const ze=N=>(le("data-v-3a487782"),N=N(),ae(),N),Ge=ze(()=>d("div",{class:"text-h6"},"For Provisioning",-1)),Ke=q({__name:"AddNewClient",props:{isOpen:{type:Boolean},serialAndMac:{},client:{},closeModal:{type:Function}},setup(N){const p=N,{isOpen:m}=R(p),f=()=>{p.closeModal()},V=[{label:"Gusa 1",value:"172.16.0.2"},{label:"Gusa 2",value:"172.16.0.10"}],g=c(""),a=B({clientId:0,accountNumber:"",packageType:"",serialAndMac:{serialNum:{label:"",idx:0},macAddress:""},oltIp:"",ipAssign:"",clientName:""});ye(()=>{var n,t;a.serialAndMac.serialNum.label=(n=p.client)==null?void 0:n.onuSerialNumber,a.serialAndMac.macAddress=(t=p.client)==null?void 0:t.onuMacAddress}),H(()=>{var n,t,i,I,r,y;a.clientId=(n=p.client)==null?void 0:n.id,a.accountNumber=(t=p.client)==null?void 0:t.accountNumber,a.clientName=(i=p.client)==null?void 0:i.clientName,a.ipAssign=(I=p.client)==null?void 0:I.ipAssigned,a.oltIp=(r=p.client)==null?void 0:r.oltIp,a.packageType=(y=p.client)==null?void 0:y.packageTypeId});const v=async()=>{console.log(a);try{await Ce(a.clientId,a.ipAssign,a.serialAndMac.serialNum.label,a.oltIp,a.serialAndMac.macAddress)&&(g.value="Successfull Client Update!")}catch(n){g.value="Unsuccessful client Update: "+n}try{const n=await ke(a.accountNumber,a.clientName,a.serialAndMac.serialNum.label,a.serialAndMac.macAddress,a.ipAssign,a.oltIp,a.packageType);g.value=n}catch{throw new Error("Provoision Not complete")}},w=async()=>{const[n]=await he(),{ipAddress:t}=n;a.ipAssign=t},o=()=>{a.serialAndMac.macAddress=p.serialAndMac[a.serialAndMac.serialNum.idx].mac_address};return(n,t)=>(P(),x(L,null,{default:s(()=>[e(j,{modelValue:T(m),"onUpdate:modelValue":t[7]||(t[7]=i=>ee(m)?m.value=i:null),persistent:""},{default:s(()=>[e(U,null,{default:s(()=>[e(D,null,{default:s(()=>[Ge]),_:1}),e(D,{class:"q-pt-none flex-client"},{default:s(()=>[e(S,{modelValue:a.accountNumber,"onUpdate:modelValue":t[0]||(t[0]=i=>a.accountNumber=i),filled:"",label:"Account Number",readonly:""},null,8,["modelValue"]),e(S,{modelValue:a.clientName,"onUpdate:modelValue":t[1]||(t[1]=i=>a.clientName=i),filled:"",label:"Client Name",readonly:""},null,8,["modelValue"]),e(S,{modelValue:a.ipAssign,"onUpdate:modelValue":t[2]||(t[2]=i=>a.ipAssign=i),filled:"",label:"IP Assign",readonly:""},{append:s(()=>[e(E,{name:"add",class:"cursor-pointer",onClick:w})]),_:1},8,["modelValue"]),e(S,{modelValue:a.packageType,"onUpdate:modelValue":t[3]||(t[3]=i=>a.packageType=i),filled:"",label:"Package Type",readonly:""},null,8,["modelValue"]),e($,{outlined:"",modelValue:a.serialAndMac.serialNum,"onUpdate:modelValue":[t[4]||(t[4]=i=>a.serialAndMac.serialNum=i),o],options:n.serialAndMac.map((i,I)=>({label:i.serial_number,idx:I})),label:"ONU Seriual Number"},null,8,["modelValue","options"]),e(S,{modelValue:a.serialAndMac.macAddress,"onUpdate:modelValue":t[5]||(t[5]=i=>a.serialAndMac.macAddress=i),filled:"",label:"ONU Mac Address",readonly:""},null,8,["modelValue"]),e($,{outlined:"",modelValue:a.oltIp,"onUpdate:modelValue":t[6]||(t[6]=i=>a.oltIp=i),options:V,label:"OLT","emit-value":"","map-options":""},null,8,["modelValue"]),e(z,{align:"right"},{default:s(()=>[e(h,{flat:"",label:"OK",color:"primary",onClick:v}),e(h,{flat:"",label:"close",color:"primary",onClick:f})]),_:1})]),_:1}),e(O,{class:"bg-primary text-white"},{default:s(()=>[A(" Response: "+b(g.value),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});var We=F(Ke,[["__scopeId","data-v-3a487782"]]);const rl=q({__name:"InetConfig",setup(N){const p=se(),m=c(),f=c([]),V=c(""),g=p.$state.subscribercolumns,a=c(!1),v=c(""),w=c(0),o=c(!1);let n=[];const t=c({id:0,accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuDeviceName:"",onuMacAddress:"",packageTypeId:""}),i=async M=>{a.value=!a.value,n=(await Te()).map(l=>({serial_number:l.serial_number,mac_address:l.mac_address})),t.value=await te(M)},I=()=>{a.value=!a.value},r=(M,C)=>{v.value=M,w.value=C,o.value=!o.value,console.log(v.value,w.value)},y=()=>{o.value=!o.value},_=async()=>{f.value=[],f.value=await X()};return H(async()=>{f.value=await X()}),(M,C)=>(P(),x(L,{padding:""},{default:s(()=>[e(ge,{rows:f.value,title:"For Provision","row-key":"name",columns:T(g),loading:!(f.value.length>0),pagination:{rowsPerPage:10},dense:M.$q.screen.lt.md},{"body-cell-actions":s(l=>[e(fe,{props:l},{default:s(()=>[e(h,{dense:"",round:"",flat:"",icon:"assignment",onClick:u=>i(l.row.id)},null,8,["onClick"]),e(h,{dense:"",round:"",flat:"",icon:"build",onClick:u=>r(l.row.onuDeviceName,l.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),"top-right":s(()=>[e(h,{icon:"autorenew",class:"cursor-pointer q-mx-sm",onClick:_,flat:""}),e(S,{modelValue:V.value,"onUpdate:modelValue":C[0]||(C[0]=l=>V.value=l),filled:"",dense:"",label:"Search",debounce:"300",color:"primary"},{append:s(()=>[e(E,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","loading","dense"]),e(We,{"is-open":a.value,onOpenModal:i,"serial-and-mac":T(n),client:t.value,"close-modal":I},null,8,["is-open","serial-and-mac","client"]),e($e,{confirm:o.value,"close-modal":y,"device-name":v.value,clientId:w.value},null,8,["confirm","device-name","clientId"]),e(He,{"data-id":m.value,"get-subsribers":_},null,8,["data-id"])]),_:1}))}});export{rl as default};
