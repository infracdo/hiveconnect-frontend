import{Q as U,a as $,c as le,h as oe,L as se,M as ne,N as ie}from"./hiveConnect.06ec3697.js";import{a1 as q,f as n,ag as ue,r as M,w as re,Y as C,a2 as T,a3 as t,$ as a,ai as l,a5 as p,a6 as s,ao as V,a0 as B,a4 as H,aj as A,at as ce,_ as j,ak as de,al as me,o as pe,Q as O}from"./index.00c2ca2a.js";import{Q as ve,a as fe}from"./QInput.f5123e24.js";import{a as _e,u as be,Q as ge}from"./use-quasar.bb2ee1e9.js";import{a as he}from"./QTable.d34938b6.js";import{Q as Ne}from"./QAjaxBar.ed3d022e.js";import{Q}from"./QBanner.abbda632.js";import{Q as D,a as P}from"./QCard.c657ca03.js";import{Q as we}from"./QCardActions.23c5ce40.js";import{a as x}from"./axios.66c02ff4.js";import"./QItem.fed542d7.js";import"./QList.4aa8ec46.js";const Se=b=>(de("data-v-89601624"),b=b(),me(),b),ye={class:"provision-info"},Ie=Se(()=>l("br",null,null,-1)),De=["src"],Ce=q({__name:"TroubleshootClient",props:{confirm:{type:Boolean},closeModal:{type:Function},deviceName:{},clientId:{}},setup(b){const y=_e(),v=b,g=n(!1),{confirm:i}=ue(v),S=()=>{v.closeModal()},u=n({__name__:"",device_name:"",device_role:"",instance:"",job:"",site_name:"",site_status:"",site_tenant:"",olt_ip:""}),r=n("2d"),f=n(""),_=n(""),e=M({accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuMacAddress:"",onuDeviceName:"",packageTypeId:"",oltSite:"",oltInterface:"",SSID:""}),c=M({upStream:"",downStream:"",name:""}),I=[{label:"Last 5 minutes",value:"5m"},{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 3 hours",value:"3h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 2 days",value:"2d"},{label:"Last 90 days",value:"90d"}],h=()=>{y.notify({message:"Gathering SNMP Data! Please wait for a moment.",color:"warning",position:"top"})},d=async(N,w)=>{console.log(N),y.loading.show();try{if(!N){o();return}const m=await x.get(`http://172.91.0.156:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${N}"}`);u.value=m.data.data.result[0].metric,f.value=m.data.data.result[0].value[1];const R=u.value.olt_ip,z=await x.get(`http://172.91.0.156:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="OLT-${R}"}`);_.value=z.data.data.result[0].value[1];const{accountNumber:E,clientName:F,ipAssigned:G,onuSerialNumber:Y,oltInterface:J,oltIp:K,onuDeviceName:W,onuMacAddress:X,packageTypeId:L,ssidName:Z}=await oe(w);e.accountNumber=E,e.clientName=F,e.ipAssigned=G,e.oltIp=K,e.SSID=Z,e.oltInterface=J,e.onuDeviceName=W,e.onuMacAddress=X,e.onuSerialNumber=Y,e.packageTypeId=L;try{const k=await se(e.oltIp);e.oltSite=k.oltName;const{upstream:ee,downstream:ae,name:te}=await ne(L);c.name=te,c.upStream=ee,c.downStream=ae}catch(k){throw k}g.value=!0}catch(m){console.log(m),o()}y.loading.hide()},o=()=>{S(),h()};return re(i,()=>{i.value===!0&&d(v.deviceName,v.clientId)}),(N,w)=>(C(),T(U,null,{default:t(()=>[a(Ne,{ref:"bar",color:"info",position:"bottom",size:"10px","skip-hijack":""},null,512),a(le,{modelValue:A(i),"onUpdate:modelValue":w[1]||(w[1]=m=>ce(i)?i.value=m:null),persistent:"","transition-show":"flip-down","transition-hide":"flip-up"},{default:t(()=>[g.value?(C(),T(D,{key:0,class:"dialog-content"},{default:t(()=>[l("div",ye,[a(D,null,{default:t(()=>[a(Q,{class:"bg-primary text-white"},{default:t(()=>[p(" Client Details ")]),_:1}),a(P,null,{default:t(()=>[l("p",null,"Client Name: "+s(e.clientName),1),l("p",null,"Account Number: "+s(e.accountNumber),1),l("p",null,"Package Type: "+s(c.name),1),l("p",null,"SSID Name: "+s(e.SSID),1)]),_:1})]),_:1}),a(D,null,{default:t(()=>[a(Q,{class:"bg-primary text-white"},{default:t(()=>[p(" ONU Details ")]),_:1}),a(P,null,{default:t(()=>[l("p",null,[p(" ONU Status: "),l("span",{style:V(f.value==="1"?"color: green":"color: red")},s(f.value==="1"?"UP":"Down"),5)]),l("p",null,"ONU IP: "+s(e.ipAssigned),1),l("p",null,"ONU Serial Number: "+s(e.onuSerialNumber),1),l("p",null,"ONU Mac Address: "+s(e.onuMacAddress),1),l("p",null,[p(" UP stream: "+s(c.upStream)+" kbps ",1),Ie,p(" Down stream: "+s(c.downStream)+" kbps ",1)])]),_:1})]),_:1}),a(D,null,{default:t(()=>[a(Q,{class:"bg-primary text-white"},{default:t(()=>[p(" OLT Details ")]),_:1}),a(P,null,{default:t(()=>[l("p",null,[p(" OLT Status: "),l("span",{style:V(_.value==="1"?"color: green":"color: red")},s(_.value==="1"?"UP":"Down"),5)]),l("p",null," OLT IP: "+s(e.oltIp),1),l("p",null,"OLT Site: "+s(e.oltSite),1),l("p",null,"OLT Interface: "+s(e.oltInterface),1)]),_:1})]),_:1})]),a($,{modelValue:r.value,"onUpdate:modelValue":w[0]||(w[0]=m=>r.value=m),options:I,label:"Select Time",filled:"",class:"select-time q-py-md","emit-value":"","map-options":""},null,8,["modelValue"]),l("iframe",{src:`http://172.91.0.174:3000/d-solo/d94d1e0e-a6e4-45c4-847f-6603e1c31ccb/subscribers-traffic-rate-and-uptime?orgId=1&from=now-${r.value}&to=now&var-Subscriber=${N.deviceName}&panelId=3`,class:"grafana-panel",frameborder:"0"},null,8,De),a(we,{vertical:"",align:"right"},{default:t(()=>[a(B,{filled:"",label:"Close",color:"red",onClick:S})]),_:1})]),_:1})):H("",!0)]),_:1},8,["modelValue"])]),_:1}))}});var Te=j(Ce,[["__scopeId","data-v-89601624"]]);const ke={class:"table-top-right"},Qe=q({__name:"HiveProvisioned",setup(b){const v=be().$state.subscribercolumns,g=n([]),i=n(""),S=n(0),u=n(!1),r=n(""),f=n(["accountNumber","clientName","ipAssigned","onuSerialNumber","onuMacAddress","oltIp","packageTypeId","ssidName","actions"]),_=n(!1),e=(h,d)=>{i.value=h,S.value=d,u.value=!u.value},c=()=>{u.value=!u.value};pe(async()=>{await I()});const I=async()=>{r.value="",_.value=!0,g.value=[],g.value=await ie(),_.value=!1};return(h,d)=>(C(),T(U,{padding:""},{default:t(()=>[a(he,{class:"my-sticky-last-column-table",title:"Hive Connect Provisioned","row-key":"name",columns:A(v),rows:g.value,loading:_.value,pagination:{rowsPerPage:10},dense:h.$q.screen.lt.md,filter:r.value,"visible-columns":f.value},{"top-right":t(()=>[l("div",ke,[a($,{modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=o=>f.value=o),multiple:"",outlined:"",dense:"","options-dense":"","display-value":h.$q.lang.table.columns,"emit-value":"","map-options":"",options:A(v),"option-value":"name","options-cover":"",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"]),a(ve,{modelValue:r.value,"onUpdate:modelValue":d[1]||(d[1]=o=>r.value=o),filled:"",dense:"",label:"Search",debounce:"300",color:"primary",clearable:""},{append:t(()=>[a(O,{name:"search"})]),_:1},8,["modelValue"]),a(O,{name:"autorenew",class:"cursor-pointer q-ma-sm",size:"sm",onClick:I,flat:""})])]),"body-cell-actions":t(o=>[a(fe,{props:o},{default:t(()=>[a(B,{dense:"",round:"",flat:"",icon:"build",onClick:N=>e(o.row.onuDeviceName+"-"+o.row.ipAssigned,o.row.id),disable:o.row.onuDeviceName===null||o.row.onuDeviceName===""},{default:t(()=>[o.row.onuDeviceName===null||o.row.onuDeviceName===""?(C(),T(ge,{key:0,anchor:"center left",self:"center right",offset:[10,10]},{default:t(()=>[p(" Device Name Missing! ")]),_:1})):H("",!0)]),_:2},1032,["onClick","disable"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","dense","filter","visible-columns"]),a(Te,{confirm:u.value,"close-modal":c,"device-name":i.value,clientId:S.value},null,8,["confirm","device-name","clientId"])]),_:1}))}});var je=j(Qe,[["__scopeId","data-v-52902278"]]);export{je as default};
