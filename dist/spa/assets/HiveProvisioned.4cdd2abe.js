import{a0 as H,f as n,a6 as re,ak as ue,r as $,w as ce,Y as T,a1 as C,a2 as o,_ as t,am as a,a4 as p,a5 as l,ap as x,a8 as k,$ as R,a3 as j,au as de,an as me,ao as pe,o as ve,Q as q}from"./index.0d3b5b64.js";import{Q as fe,a as _e}from"./QInput.2e5b6478.js";import{Q as z,a as E,c as be,h as ge,J as Se,K as he,L as we,M as Ne}from"./hiveConnect.5a039ac3.js";import{u as ye,Q as Ie}from"./QTooltip.c1132b63.js";import{a as De}from"./QTable.8201ad59.js";import{Q as Te}from"./QAjaxBar.ed128fcc.js";import{Q as O}from"./QBanner.4a618d50.js";import{Q as D,a as A}from"./QCard.a555b0fe.js";import{Q as Ce}from"./QCardActions.c3dfd053.js";import{a as B}from"./axios.66c02ff4.js";import{_ as F}from"./plugin-vue_export-helper.21dcd24c.js";import"./QItem.03b102c2.js";import"./QList.0a09d8e9.js";const ke=S=>(me("data-v-312873a1"),S=S(),pe(),S),Qe={class:"provision-info"},Oe=ke(()=>a("br",null,null,-1)),Ae=["src"],Le=H({__name:"TroubleshootClient",props:{confirm:{type:Boolean},closeModal:{type:Function},deviceName:{},clientId:{}},setup(S){n(!0);const y=re(),v=S,h=n(!1),{confirm:r}=ue(v),w=()=>{v.closeModal()},u=n({__name__:"",device_name:"",device_role:"",instance:"",job:"",site_name:"",site_status:"",site_tenant:"",olt_ip:"",vlan_690_ip:"",provisioned_by:""}),c=n("2d"),f=n(""),_=n(""),e=$({accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuMacAddress:"",onuDeviceName:"",packageTypeId:"",oltSite:"",oltInterface:"",SSID:"",otcStatus:"",oltUpstream:"",oltDownstream:""}),d=$({upStream:"",downStream:"",name:""}),I=[{label:"Last 5 minutes",value:"5m"},{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 3 hours",value:"3h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 2 days",value:"2d"},{label:"Last 90 days",value:"90d"}],b="https://dctech-prometheus.apolloglobal.net",m="https://dctech-grafana.apolloglobal.net",s=()=>{y.notify({message:"Gathering SNMP Data! Please wait for a moment.",color:"warning",position:"top"})},L=async(N,g)=>{console.log(N),y.loading.show();try{if(!N){P();return}const i=await B.get(`${b}/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${N}"}`);console.log("ONU Prometheus: ",i.data.data.result[0].metric),u.value=i.data.data.result[0].metric,f.value=i.data.data.result[0].value[1];const G=u.value.olt_ip,J=await B.get(`${b}/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="OLT-${G}"}`);_.value=J.data.data.result[0].value[1];const{accountNumber:K,clientName:Y,ipAssigned:W,onuSerialNumber:X,oltInterface:Z,oltIp:ee,onuDeviceName:ae,onuMacAddress:te,packageTypeId:M,ssidName:oe,oltReportedDownstream:U,oltReportedUpstream:V}=await ge(g),le=await Se(g);e.otcStatus=le,e.accountNumber=K,e.clientName=Y,e.ipAssigned=W,e.oltIp=ee,e.SSID=oe,e.oltInterface=Z,e.onuDeviceName=ae,e.onuMacAddress=te,e.onuSerialNumber=X,e.packageTypeId=M,e.oltUpstream=V,e.oltDownstream=U,console.log(V,U);try{const Q=await he(e.oltIp);e.oltSite=Q.oltName;const{upstream:se,downstream:ne,name:ie}=await we(M);d.name=ie,d.upStream=se,d.downStream=ne}catch(Q){throw Q}h.value=!0}catch(i){console.log(i),P()}y.loading.hide()},P=()=>{w(),s()};return ce(r,()=>{r.value===!0&&L(v.deviceName,v.clientId)}),(N,g)=>(T(),C(z,null,{default:o(()=>[t(Te,{ref:"bar",color:"info",position:"bottom",size:"10px","skip-hijack":""},null,512),t(be,{modelValue:k(r),"onUpdate:modelValue":g[1]||(g[1]=i=>de(r)?r.value=i:null),persistent:"","transition-show":"flip-down","transition-hide":"flip-up"},{default:o(()=>[h.value?(T(),C(D,{key:0,class:"dialog-content"},{default:o(()=>[a("div",Qe,[t(D,null,{default:o(()=>[t(O,{class:"bg-primary text-white"},{default:o(()=>[p(" Client Details ")]),_:1}),t(A,null,{default:o(()=>[a("p",null,"Client Name: "+l(e.clientName),1),a("p",null,"Account Number: "+l(e.accountNumber),1),a("p",null,"Payment Status: "+l(e.otcStatus),1),a("p",null,"Package Type: "+l(d.name),1)]),_:1})]),_:1}),t(D,null,{default:o(()=>[t(O,{class:"bg-primary text-white"},{default:o(()=>[p(" ONU Details ")]),_:1}),t(A,null,{default:o(()=>[a("p",null,[p(" ONU Status: "),a("span",{style:x(f.value==="1"?"color: green":"color: red")},l(f.value==="1"?"Online":"Offline"),5)]),a("p",null,"ONU IP: "+l(e.ipAssigned),1),a("p",null,"SSID Name: "+l(e.SSID),1),a("p",null,"ONU Serial Number: "+l(e.onuSerialNumber),1),a("p",null,"ONU Mac Address: "+l(e.onuMacAddress),1),a("p",null,[p(" UP stream: "+l(d.upStream)+" kbps ",1),Oe,p(" Down stream: "+l(d.downStream)+" kbps ",1)])]),_:1})]),_:1}),t(D,null,{default:o(()=>[t(O,{class:"bg-primary text-white"},{default:o(()=>[p(" OLT Details ")]),_:1}),t(A,null,{default:o(()=>[a("p",null,[p(" OLT Status: "),a("span",{style:x(_.value==="1"?"color: green":"color: red")},l(_.value==="1"?"Online":"Offline"),5)]),a("p",null," OLT IP: "+l(e.oltIp),1),a("p",null,"OLT Site: "+l(e.oltSite),1),a("p",null,"OLT Interface: "+l(e.oltInterface),1),a("p",null,"OLT Up Stream: "+l(e.oltUpstream),1),a("p",null,"OLT Down Stream: "+l(e.oltDownstream),1)]),_:1})]),_:1})]),t(E,{modelValue:c.value,"onUpdate:modelValue":g[0]||(g[0]=i=>c.value=i),options:I,label:"Select Time",filled:"",class:"select-time q-py-md","emit-value":"","map-options":""},null,8,["modelValue"]),a("iframe",{src:`${k(m)}/d-solo/d94d1e0e-a6e4-45c4-847f-6603e1c31ccb/subscribers-traffic-rate-and-uptime?orgId=1&from=now-${c.value}&to=now&var-Subscriber=${N.deviceName}&panelId=3`,class:"grafana-panel",frameborder:"0"},null,8,Ae),t(Ce,{vertical:"",align:"right"},{default:o(()=>[t(R,{filled:"",label:"Close",color:"red",onClick:w})]),_:1})]),_:1})):j("",!0)]),_:1},8,["modelValue"])]),_:1}))}});var Pe=F(Le,[["__scopeId","data-v-312873a1"]]);const Me={class:"table-top-right"},Ue=H({__name:"HiveProvisioned",setup(S){const v=ye().$state.subscribercolumns,h=n([]),r=n(""),w=n(0),u=n(!1),c=n(""),f=n(["accountNumber","clientName","ipAssigned","onuSerialNumber","onuMacAddress","oltIp","packageTypeId","ssidName","actions"]),_=n(!1),e=(b,m)=>{r.value=b,w.value=m,u.value=!u.value},d=()=>{u.value=!u.value};ve(async()=>{await I()});const I=async()=>{c.value="",_.value=!0,h.value=[],h.value=await Ne(),_.value=!1};return(b,m)=>(T(),C(z,{padding:""},{default:o(()=>[t(De,{class:"my-sticky-last-column-table",title:"Hive Connect Provisioned","row-key":"name",columns:k(v),rows:h.value,loading:_.value,pagination:{rowsPerPage:10},dense:b.$q.screen.lt.md,filter:c.value,"visible-columns":f.value},{"top-right":o(()=>[a("div",Me,[t(fe,{modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=s=>c.value=s),filled:"",dense:"",label:"Search",debounce:"300",color:"primary",clearable:""},{append:o(()=>[t(q,{name:"search"})]),_:1},8,["modelValue"]),t(E,{modelValue:f.value,"onUpdate:modelValue":m[1]||(m[1]=s=>f.value=s),multiple:"",outlined:"",dense:"","options-dense":"","display-value":b.$q.lang.table.columns,"emit-value":"","map-options":"",options:k(v),"option-value":"name","options-cover":"",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"]),t(q,{name:"autorenew",class:"cursor-pointer q-ma-sm",size:"sm",onClick:I,flat:""})])]),"body-cell-actions":o(s=>[t(_e,{props:s},{default:o(()=>[t(R,{dense:"",round:"",flat:"",icon:"build",onClick:L=>e(s.row.onuDeviceName+"-"+s.row.ipAssigned,s.row.id),disable:s.row.onuDeviceName===null||s.row.onuDeviceName===""},{default:o(()=>[s.row.onuDeviceName===null||s.row.onuDeviceName===""?(T(),C(Ie,{key:0,anchor:"center left",self:"center right",offset:[10,10]},{default:o(()=>[p(" Device Name Missing! ")]),_:1})):j("",!0)]),_:2},1032,["onClick","disable"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","dense","filter","visible-columns"]),t(Pe,{confirm:u.value,"close-modal":d,"device-name":r.value,clientId:w.value},null,8,["confirm","device-name","clientId"])]),_:1}))}});var Ke=F(Ue,[["__scopeId","data-v-7e555512"]]);export{Ke as default};
