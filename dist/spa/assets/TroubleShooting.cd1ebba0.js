import{c as R,a as C}from"./QPage.170b55ae.js";import{g as F}from"./QBtn.02bb7391.js";import{Q as N}from"./QBanner.7bf4760a.js";import{a as y,Q as g}from"./QCard.361bb5f7.js";import{a as G,b as W,f as X,h as Y,i as Z}from"./networkAddressAPIs.0547eb9b.js";import{a as L}from"./axios.a596eead.js";import{_ as ee,J as ae,r as i,H as D,o as te,K as d,L as se,M as n,a4 as a,N as s,S as _,P as c,Q as t,an as O,O as v}from"./index.91daecd0.js";import"./QItem.993472b1.js";const le={class:"select"},oe={key:0,class:"my-cards"},ne={class:""},ue={class:""},ie={style:{}},ce={class:""},re={class:""},de={style:{}},me={class:"grafana-main"},pe={key:0,class:"grafana"},_e=["src"],ve=ae({__name:"TroubleShooting",setup(be){const u=i({label:"",id:0}),b=i(!1),m=i(""),w=i([]),f=i({__name__:"",device_name:"",device_role:"",instance:"",job:"",site_name:"",site_status:"",site_tenant:""}),h=i(""),S=i(""),x=[{label:"Last 5 minutes",value:"5m"},{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 3 hours",value:"3h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 2 days",value:"2d"},{label:"Last 90 days",value:"90d"}],e=D({accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuMacAddress:"",onuDeviceName:"",packageTypeId:"",oltSite:"",oltInterface:""}),p=D({upStream:"",downStream:""}),I=async()=>{const r=await G();w.value=r.map(l=>({onuDeviceName:l.onuDeviceName,id:l.id}))},A=async(r,l)=>{const o=await L.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${r}"}`);f.value=o.data.data.result[0].metric,h.value=o.data.data.result[0].value[1];const P=await L.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${f.value.site_name}"}`);S.value=P.data.data.result[0].value[1];const V=await W(l),{accountNumber:B,clientName:Q,ipAssigned:U,oltIp:T,onuDeviceName:M,onuMacAddress:q,onuSerialNumber:$,packageTypeId:k}=V;e.accountNumber=B,e.clientName=Q,e.ipAssigned=U,e.oltIp=T,e.onuDeviceName=M,e.onuMacAddress=q,e.onuSerialNumber=$,e.packageTypeId=k;const j=await X(T),{olt_site:E}=j;e.oltSite=E;const H=await Y(k),{upstream:z,downstream:J}=H;p.upStream=z,p.downStream=J;const K=await Z(r);e.oltInterface=K,b.value=!0};return te(()=>{I()}),(r,l)=>(d(),se(R,{padding:""},{default:n(()=>[a("div",le,[s(C,{modelValue:u.value,"onUpdate:modelValue":[l[0]||(l[0]=o=>u.value=o),l[1]||(l[1]=o=>A(u.value.label,u.value.id))],options:w.value.map(o=>({label:o.onuDeviceName,id:o.id})),label:"Select Subscriber",filled:"",class:"select-subscriber","map-option":""},null,8,["modelValue","options"]),s(C,{modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=o=>m.value=o),options:x,label:"Select Time",filled:"",class:"select-subscriber","emit-value":"","map-options":""},null,8,["modelValue"]),s(F,{icon:"autorenew",class:"cursor-pointer q-mx-sm",onClick:I,flat:""})]),b.value?(d(),_("div",oe,[s(g,null,{default:n(()=>[s(N,{class:"bg-primary text-white"},{default:n(()=>[c(" Client Details ")]),_:1}),s(y,null,{default:n(()=>[a("p",null,"Client Name: "+t(e.clientName),1),a("p",null,"Account Number: "+t(e.accountNumber),1),a("p",null,"Package Type: "+t(e.packageTypeId),1)]),_:1})]),_:1}),s(g,null,{default:n(()=>[s(N,{class:"bg-primary text-white"},{default:n(()=>[c(" ONU Details ")]),_:1}),s(y,null,{default:n(()=>[a("p",ne,[c(" ONU Status: "),u.value.label!==""?(d(),_("span",{key:0,class:O(h.value==="1"?"up":"down")},t(h.value==="1"?"UP":"Down"),3)):v("",!0)]),a("p",ue,[c(" ONU IP: "),a("span",ie,t(f.value.instance),1)]),a("p",null,"ONU Serial Number: "+t(e.onuSerialNumber),1),a("p",null,"ONU Mac Address: "+t(e.onuMacAddress),1),a("p",null," upstream: "+t(p.upStream)+" downstream: "+t(p.downStream),1)]),_:1})]),_:1}),s(g,null,{default:n(()=>[s(N,{class:"bg-primary text-white"},{default:n(()=>[c(" OLT Details ")]),_:1}),s(y,null,{default:n(()=>[a("p",ce,[c(" OLT Status: "),u.value.label!==""?(d(),_("span",{key:0,class:O(S.value==="1"?"up":"down")},t(S.value==="1"?"UP":"Down"),3)):v("",!0)]),a("p",re,[c(" OLT IP: "),a("span",de,t(e.oltIp),1)]),a("p",null,"OLT Site: "+t(e.oltSite),1),a("p",null,"OLT Interface: "+t(e.oltInterface),1)]),_:1})]),_:1})])):v("",!0),a("div",me,[b.value&&m.value!==""?(d(),_("div",pe,[a("div",null,[a("iframe",{src:`http://172.91.10.151:3000/d-solo/d94d1e0e-a6e4-45c4-847f-6603e1c31ccb/subscribers-traffic-rate-and-uptime?orgId=1&from=now-${m.value}&to=now&var-Subscriber=${u.value.label}&panelId=3`,class:"grafana-panel",frameborder:"0"},null,8,_e)])])):v("",!0)])]),_:1}))}});var Te=ee(ve,[["__scopeId","data-v-74cec4ac"]]);export{Te as default};
