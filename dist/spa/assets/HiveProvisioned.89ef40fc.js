import{_ as q,r as n,a4 as ne,ai as ie,U as V,w as ue,W as D,$ as k,a0 as l,Y as a,ak as t,a2 as p,a3 as o,an as $,a6 as Q,Z as B,a1 as H,as as re,al as ce,am as de,o as me,Q as x}from"./index.a2f31a4e.js";import{Q as pe,a as ve}from"./QInput.c3fd2c23.js";import{Q as j,b as R,d as fe,a as U,i as _e,K as be,L as ge,M as Se,N as he}from"./hiveConnect.ec21bf8f.js";import{u as Ne,Q as we}from"./QTooltip.4a55cb7b.js";import{a as ye}from"./QTable.f47332ff.js";import{Q as Ie}from"./QAjaxBar.ee133c75.js";import{Q as A}from"./QBanner.1bc988be.js";import{Q as T,a as O}from"./QCard.98bb8bd8.js";import{Q as Ce}from"./QCardActions.49deb072.js";import{_ as z}from"./plugin-vue_export-helper.21dcd24c.js";import"./QItem.501a98fd.js";import"./QList.df7c248f.js";const Te=S=>(ce("data-v-63a6e6c7"),S=S(),de(),S),De={class:"provision-info"},ke=Te(()=>t("br",null,null,-1)),Qe=["src"],Ae=q({__name:"TroubleshootClient",props:{confirm:{type:Boolean},closeModal:{type:Function},deviceName:{},clientId:{}},setup(S){n(!0);const y=ne(),v=S,h=n(!1),{confirm:i}=ie(v),N=()=>{v.closeModal()},u=n({__name__:"",device_name:"",device_role:"",instance:"",job:"",site_name:"",site_status:"",site_tenant:"",olt_ip:""}),r=n("2d"),f=n(""),_=n(""),e=V({accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuMacAddress:"",onuDeviceName:"",packageTypeId:"",oltSite:"",oltInterface:"",SSID:"",otcStatus:""}),c=V({upStream:"",downStream:"",name:""}),I=[{label:"Last 5 minutes",value:"5m"},{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 3 hours",value:"3h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 2 days",value:"2d"},{label:"Last 90 days",value:"90d"}],b="https://dctech-prometheus.apolloglobal.net",d="https://dctech-grafana.apolloglobal.net",s=()=>{y.notify({message:"Gathering SNMP Data! Please wait for a moment.",color:"warning",position:"top"})},L=async(w,g)=>{console.log(w),y.loading.show();try{if(!w){P();return}const m=await U.get(`${b}/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${w}"}`);u.value=m.data.data.result[0].metric,f.value=m.data.data.result[0].value[1];const E=u.value.olt_ip,F=await U.get(`${b}/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="OLT-${E}"}`);_.value=F.data.data.result[0].value[1];const{accountNumber:G,clientName:K,ipAssigned:W,onuSerialNumber:Y,oltInterface:Z,oltIp:J,onuDeviceName:X,onuMacAddress:ee,packageTypeId:M,ssidName:ae}=await _e(g),te=await be(g);e.otcStatus=te,e.accountNumber=G,e.clientName=K,e.ipAssigned=W,e.oltIp=J,e.SSID=ae,e.oltInterface=Z,e.onuDeviceName=X,e.onuMacAddress=ee,e.onuSerialNumber=Y,e.packageTypeId=M;try{const C=await ge(e.oltIp);console.log(C),e.oltSite=C.oltName;const{upstream:le,downstream:oe,name:se}=await Se(M);c.name=se,c.upStream=le,c.downStream=oe}catch(C){throw C}h.value=!0}catch(m){console.log(m),P()}y.loading.hide()},P=()=>{N(),s()};return ue(i,()=>{i.value===!0&&L(v.deviceName,v.clientId)}),(w,g)=>(D(),k(j,null,{default:l(()=>[a(Ie,{ref:"bar",color:"info",position:"bottom",size:"10px","skip-hijack":""},null,512),a(fe,{modelValue:Q(i),"onUpdate:modelValue":g[1]||(g[1]=m=>re(i)?i.value=m:null),persistent:"","transition-show":"flip-down","transition-hide":"flip-up"},{default:l(()=>[h.value?(D(),k(T,{key:0,class:"dialog-content"},{default:l(()=>[t("div",De,[a(T,null,{default:l(()=>[a(A,{class:"bg-primary text-white"},{default:l(()=>[p(" Client Details ")]),_:1}),a(O,null,{default:l(()=>[t("p",null,"Client Name: "+o(e.clientName),1),t("p",null,"Account Number: "+o(e.accountNumber),1),t("p",null,"Payment StatusL "+o(e.otcStatus),1),t("p",null,"Package Type: "+o(c.name),1)]),_:1})]),_:1}),a(T,null,{default:l(()=>[a(A,{class:"bg-primary text-white"},{default:l(()=>[p(" ONU Details ")]),_:1}),a(O,null,{default:l(()=>[t("p",null,[p(" ONU Status: "),t("span",{style:$(f.value==="1"?"color: green":"color: red")},o(f.value==="1"?"Online":"Offline"),5)]),t("p",null,"ONU IP: "+o(e.ipAssigned),1),t("p",null,"SSID Name: "+o(e.SSID),1),t("p",null,"ONU Serial Number: "+o(e.onuSerialNumber),1),t("p",null,"ONU Mac Address: "+o(e.onuMacAddress),1),t("p",null,[p(" UP stream: "+o(c.upStream)+" kbps ",1),ke,p(" Down stream: "+o(c.downStream)+" kbps ",1)])]),_:1})]),_:1}),a(T,null,{default:l(()=>[a(A,{class:"bg-primary text-white"},{default:l(()=>[p(" OLT Details ")]),_:1}),a(O,null,{default:l(()=>[t("p",null,[p(" OLT Status: "),t("span",{style:$(_.value==="1"?"color: green":"color: red")},o(_.value==="1"?"Online":"Offline"),5)]),t("p",null," OLT IP: "+o(e.oltIp),1),t("p",null,"OLT Site: "+o(e.oltSite),1),t("p",null,"OLT Interface: "+o(e.oltInterface),1)]),_:1})]),_:1})]),a(R,{modelValue:r.value,"onUpdate:modelValue":g[0]||(g[0]=m=>r.value=m),options:I,label:"Select Time",filled:"",class:"select-time q-py-md","emit-value":"","map-options":""},null,8,["modelValue"]),t("iframe",{src:`${Q(d)}/d-solo/d94d1e0e-a6e4-45c4-847f-6603e1c31ccb/subscribers-traffic-rate-and-uptime?orgId=1&from=now-${r.value}&to=now&var-Subscriber=${w.deviceName}&panelId=3`,class:"grafana-panel",frameborder:"0"},null,8,Qe),a(Ce,{vertical:"",align:"right"},{default:l(()=>[a(B,{filled:"",label:"Close",color:"red",onClick:N})]),_:1})]),_:1})):H("",!0)]),_:1},8,["modelValue"])]),_:1}))}});var Oe=z(Ae,[["__scopeId","data-v-63a6e6c7"]]);const Le={class:"table-top-right"},Pe=q({__name:"HiveProvisioned",setup(S){const v=Ne().$state.subscribercolumns,h=n([]),i=n(""),N=n(0),u=n(!1),r=n(""),f=n(["accountNumber","clientName","ipAssigned","onuSerialNumber","onuMacAddress","oltIp","packageTypeId","ssidName","actions"]),_=n(!1),e=(b,d)=>{i.value=b,N.value=d,u.value=!u.value},c=()=>{u.value=!u.value};me(async()=>{await I()});const I=async()=>{r.value="",_.value=!0,h.value=[],h.value=await he(),_.value=!1};return(b,d)=>(D(),k(j,{padding:""},{default:l(()=>[a(ye,{class:"my-sticky-last-column-table",title:"Hive Connect Provisioned","row-key":"name",columns:Q(v),rows:h.value,loading:_.value,pagination:{rowsPerPage:10},dense:b.$q.screen.lt.md,filter:r.value,"visible-columns":f.value},{"top-right":l(()=>[t("div",Le,[a(pe,{modelValue:r.value,"onUpdate:modelValue":d[0]||(d[0]=s=>r.value=s),filled:"",dense:"",label:"Search",debounce:"300",color:"primary",clearable:""},{append:l(()=>[a(x,{name:"search"})]),_:1},8,["modelValue"]),a(R,{modelValue:f.value,"onUpdate:modelValue":d[1]||(d[1]=s=>f.value=s),multiple:"",outlined:"",dense:"","options-dense":"","display-value":b.$q.lang.table.columns,"emit-value":"","map-options":"",options:Q(v),"option-value":"name","options-cover":"",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"]),a(x,{name:"autorenew",class:"cursor-pointer q-ma-sm",size:"sm",onClick:I,flat:""})])]),"body-cell-actions":l(s=>[a(ve,{props:s},{default:l(()=>[a(B,{dense:"",round:"",flat:"",icon:"build",onClick:L=>e(s.row.onuDeviceName+"-"+s.row.ipAssigned,s.row.id),disable:s.row.onuDeviceName===null||s.row.onuDeviceName===""},{default:l(()=>[s.row.onuDeviceName===null||s.row.onuDeviceName===""?(D(),k(we,{key:0,anchor:"center left",self:"center right",offset:[10,10]},{default:l(()=>[p(" Device Name Missing! ")]),_:1})):H("",!0)]),_:2},1032,["onClick","disable"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","dense","filter","visible-columns"]),a(Oe,{confirm:u.value,"close-modal":c,"device-name":i.value,clientId:N.value},null,8,["confirm","device-name","clientId"])]),_:1}))}});var Fe=z(Pe,[["__scopeId","data-v-7e555512"]]);export{Fe as default};
