import{Q as D,g as A}from"./QBtn.1cd2b189.js";import{Q as b,a as ee}from"./QInput.9f5336ba.js";import{Q as le}from"./QTable.874f1ae2.js";import{Q as E,a as U,b as ae,c as Q}from"./QPage.c415a836.js";import{a1 as se,_ as F,J as O,a2 as G,r as c,H as K,a3 as P,K as T,L as x,M as d,N as a,X as C,a4 as N,P as M,Q as S,a5 as W,a6 as H,a7 as te,a8 as oe}from"./index.7efad920.js";import{Q as q,a as J}from"./QCardActions.6680ee42.js";import{Q as X,a as $}from"./QCard.9cfa2570.js";import{Q as j}from"./QBanner.a87b788d.js";import{a as y}from"./axios.a596eead.js";import{u as ne,e as ie,g as de,a as h,b as re}from"./networkAddressAPIs.0547eb9b.js";import{g as ue}from"./rougeDevicesApi.a40ecefd.js";import"./QItem.d307718a.js";import"./QList.6c15fb81.js";const z=se("subsciber",{state:()=>({subscriberDetail:{subscriber_name:"",serial_number:"",acc_no:"",package_type:"",ssid:"",password:"",mode:"",olt_ip:"",olt_interface:""},modalIsOpen:!1,subscribercolumns:[{name:"id",label:"ID",field:"id",align:"left",sortable:!0},{name:"accountNumber",label:"Account No.",field:"accountNumber",align:"left",sortable:!0},{name:"clientName",label:"Client Name",field:"clientName",align:"left",sortable:!0},{name:"ipAssigned",label:"IP Assigned",field:"ipAssigned",align:"left",sortable:!0},{name:"onuSerialNumber",label:"ONU Serial Number",field:"onuSerialNumber",align:"left",sortable:!0},{name:"onuMacAddress",label:"ONU Mac Address",field:"onuMacAddress",align:"left",sortable:!0},{name:"oltIp",label:"OLT IP",field:"oltIp",align:"left",sortable:!0},{name:"packageTypeId",label:"Package Type ID",field:"packageTypeId",align:"left",sortable:!0},{name:"actions",label:"Actions",field:"",align:"left"}]})});const k=p=>(W("data-v-7a47d3e6"),p=p(),H(),p),ce={class:""},me={class:""},pe={class:"q-gutter-sm"},be=k(()=>N("br",null,null,-1)),fe=k(()=>N("br",null,null,-1)),ve=k(()=>N("br",null,null,-1)),ge=k(()=>N("br",null,null,-1)),_e=k(()=>N("br",null,null,-1)),Ve="http://127.0.0.1:8000",R="http://172.91.0.136:7547",L="http://172.91.10.108:8080",we=O({__name:"SubscriberModal",props:["dataId","getSubsribers"],setup(p){const u=p;y.defaults.timeout=0;const r=z(),{dataId:_}=G(u),V=c(""),f=c(""),e=c(""),v=c(""),w=c(""),g=c(""),n=c(""),s=c(""),t=c(""),m=c(!0),o=K({subscriber:"",configureSsid:"",setBandwidth:"",runAnsible:"",wanConfig:""});P(()=>{V.value=r.$state.subscriberDetail.acc_no,f.value=r.$state.subscriberDetail.subscriber_name,e.value=r.$state.subscriberDetail.package_type,v.value=r.$state.subscriberDetail.serial_number,w.value=r.$state.subscriberDetail.olt_ip,g.value=r.$state.subscriberDetail.olt_interface,n.value=r.$state.subscriberDetail.mode,s.value=r.$state.subscriberDetail.ssid,t.value=r.$state.subscriberDetail.password});const I=["0/1:1","0/1:2","0/1:3","0/2:1","0/2:2","0/2:3","0/3:1","0/3:2","0/3:3"],Y=()=>{r.$state.modalIsOpen=!r.$state.modalIsOpen},Z=async B=>{await y.put(`${Ve}/api/subscriber_test/${B}/edit`,{acc_no:V.value,subscriber_name:f.value,serial_number:v.value,olt_ip:w.value,olt_interface:g.value,package_type:e.value,mode:n.value,ssid:s.value,password:t.value}).then(l=>{o.subscriber=l.data,u.getSubsribers()}).catch(l=>{o.subscriber=l}),await y.post(`${R}/configureSSID`,{SN:v.value,NewSSID:n.value==="Bridged"?"":s.value,Password:t.value}).then(l=>{o.configureSsid=l.data}).catch(l=>{o.configureSsid=l}),await y.post(`${R}/bridgedWanConfig`,{SN:v.value}).then(l=>{o.wanConfig=l.data}).catch(l=>{o.wanConfig=l}),await y.post(L+"/setBandwidth").then(l=>{if(l.data)o.setBandwidth="Bandwidth Config Success!";else throw new Error("Something went wrong!")}).catch(l=>{o.setBandwidth=l}),await y.post(L+"/runPlaybook").then(l=>{if(l.data)o.runAnsible="Successfull Setup!";else throw new Error("Something went wrong!")}).catch(l=>{o.runAnsible=l})};return(B,l)=>(T(),x(Q,null,{default:d(()=>[a(E,{modelValue:C(r).$state.modalIsOpen,"onUpdate:modelValue":l[12]||(l[12]=i=>C(r).$state.modalIsOpen=i),modelModifiers:{trim:!0}},{default:d(()=>[a(X,null,{default:d(()=>[a($,{class:"flex-subscriber"},{default:d(()=>[N("div",ce,[a(b,{modelValue:V.value,"onUpdate:modelValue":l[0]||(l[0]=i=>V.value=i),modelModifiers:{trim:!0},outlined:"",label:"Account No.",class:"q-ma-md",disable:""},null,8,["modelValue"]),a(b,{modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=i=>f.value=i),modelModifiers:{trim:!0},outlined:"",label:"Subscriber Name",class:"q-ma-md",disable:""},null,8,["modelValue"]),a(b,{modelValue:e.value,"onUpdate:modelValue":l[2]||(l[2]=i=>e.value=i),modelModifiers:{trim:!0},outlined:"",label:"Package Type",class:"q-ma-md",disable:""},null,8,["modelValue"]),a(b,{modelValue:v.value,"onUpdate:modelValue":l[3]||(l[3]=i=>v.value=i),modelModifiers:{trim:!0},outlined:"",label:"Serial Number",class:"q-ma-md"},null,8,["modelValue"]),a(U,{modelValue:w.value,"onUpdate:modelValue":l[4]||(l[4]=i=>w.value=i),modelModifiers:{trim:!0},filled:"",options:["172.16.0.2","172.16.0.58","172.16.0.22"],label:"OLT IP",class:"q-ma-md"},null,8,["modelValue"])]),N("div",me,[a(U,{modelValue:g.value,"onUpdate:modelValue":l[5]||(l[5]=i=>g.value=i),modelModifiers:{trim:!0},filled:"",options:I,label:"OLT Interface",class:"q-ma-md"},null,8,["modelValue"]),a(ae,{filled:"",label:"Mode","stack-label":"",class:"q-ma-md"},{control:d(()=>[N("div",pe,[a(q,{modelValue:n.value,"onUpdate:modelValue":l[6]||(l[6]=i=>n.value=i),modelModifiers:{trim:!0},dense:"",val:"Bridged",label:"Bridged"},null,8,["modelValue"]),a(q,{modelValue:n.value,"onUpdate:modelValue":l[7]||(l[7]=i=>n.value=i),modelModifiers:{trim:!0},dense:"",val:"Routed",label:"Routed"},null,8,["modelValue"])])]),_:1}),a(b,{modelValue:s.value,"onUpdate:modelValue":l[8]||(l[8]=i=>s.value=i),modelModifiers:{trim:!0},outlined:"",class:"q-ma-md",label:"SSID"},null,8,["modelValue"]),a(b,{modelValue:t.value,"onUpdate:modelValue":l[10]||(l[10]=i=>t.value=i),modelModifiers:{trim:!0},outlined:"",class:"q-ma-md",label:"Password",type:m.value?"password":"text"},{append:d(()=>[a(D,{name:m.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:l[9]||(l[9]=i=>m.value=!m.value)},null,8,["name"])]),_:1},8,["modelValue","type"])])]),_:1}),a(J,{align:"left"},{default:d(()=>[a(A,{flat:"",label:"Update Info",color:"secondary",onClick:l[11]||(l[11]=i=>Z(C(_)))}),a(A,{flat:"",label:"Close",color:"primary",onClick:Y})]),_:1}),a(j,{class:"bg-primary text-white"},{default:d(()=>[M(" Subscriber Details: "+S(o.subscriber)+" ",1),be,M(" SSID/Password Config: "+S(o.configureSsid)+" ",1),fe,M(" Wan Config: "+S(o.wanConfig)+" ",1),ve,M(" Bandwidth: "+S(o.setBandwidth)+" ",1),ge,M(" Playbook: "+S(o.runAnsible)+" ",1),_e]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});var Ne=F(we,[["__scopeId","data-v-7a47d3e6"]]);const Ae=p=>(W("data-v-3a487782"),p=p(),H(),p),Ie=Ae(()=>N("div",{class:"text-h6"},"For Provisioning",-1)),ye=O({__name:"AddNewClient",props:{isOpen:{type:Boolean},serialAndMac:{},client:{},closeModal:{type:Function}},setup(p){const u=p,{isOpen:r}=G(u),_=()=>{u.closeModal()},V=[{label:"Gusa 1",value:"172.16.0.2"},{label:"Gusa 2",value:"172.16.0.10"}],f=c(""),e=K({clientId:0,accountNumber:"",packageType:"",serialAndMac:{serialNum:{label:"",idx:0},macAddress:""},oltIp:"",ipAssign:"",clientName:""});te(()=>{var n,s;e.serialAndMac.serialNum.label=(n=u.client)==null?void 0:n.onuSerialNumber,e.serialAndMac.macAddress=(s=u.client)==null?void 0:s.onuMacAddress}),P(()=>{var n,s,t,m,o,I;e.clientId=(n=u.client)==null?void 0:n.id,e.accountNumber=(s=u.client)==null?void 0:s.accountNumber,e.clientName=(t=u.client)==null?void 0:t.clientName,e.ipAssign=(m=u.client)==null?void 0:m.ipAssigned,e.oltIp=(o=u.client)==null?void 0:o.oltIp,e.packageType=(I=u.client)==null?void 0:I.packageTypeId});const v=async()=>{console.log(e);try{await ne(e.clientId,e.ipAssign,e.serialAndMac.serialNum.label,e.oltIp,e.serialAndMac.macAddress)&&(f.value="Successfull Client Update!")}catch(n){f.value="Unsuccessful client Update: "+n}try{const n=await ie(e.accountNumber,e.clientName,e.serialAndMac.serialNum.label,e.serialAndMac.macAddress,e.ipAssign,e.oltIp,e.packageType);f.value=n}catch{throw new Error("Provoision Not complete")}},w=async()=>{const[n]=await de(),{ipAddress:s}=n;e.ipAssign=s},g=()=>{e.serialAndMac.macAddress=u.serialAndMac[e.serialAndMac.serialNum.idx].mac_address};return(n,s)=>(T(),x(Q,null,{default:d(()=>[a(E,{modelValue:C(r),"onUpdate:modelValue":s[7]||(s[7]=t=>oe(r)?r.value=t:null),persistent:""},{default:d(()=>[a(X,null,{default:d(()=>[a($,null,{default:d(()=>[Ie]),_:1}),a($,{class:"q-pt-none flex-client"},{default:d(()=>[a(b,{modelValue:e.accountNumber,"onUpdate:modelValue":s[0]||(s[0]=t=>e.accountNumber=t),filled:"",label:"Account Number",readonly:""},null,8,["modelValue"]),a(b,{modelValue:e.clientName,"onUpdate:modelValue":s[1]||(s[1]=t=>e.clientName=t),filled:"",label:"Client Name",readonly:""},null,8,["modelValue"]),a(b,{modelValue:e.ipAssign,"onUpdate:modelValue":s[2]||(s[2]=t=>e.ipAssign=t),filled:"",label:"IP Assign",readonly:""},{append:d(()=>[a(D,{name:"add",class:"cursor-pointer",onClick:w})]),_:1},8,["modelValue"]),a(b,{modelValue:e.packageType,"onUpdate:modelValue":s[3]||(s[3]=t=>e.packageType=t),filled:"",label:"Package Type",readonly:""},null,8,["modelValue"]),a(U,{outlined:"",modelValue:e.serialAndMac.serialNum,"onUpdate:modelValue":[s[4]||(s[4]=t=>e.serialAndMac.serialNum=t),g],options:n.serialAndMac.map((t,m)=>({label:t.serial_number,idx:m})),label:"ONU Seriual Number"},null,8,["modelValue","options"]),a(b,{modelValue:e.serialAndMac.macAddress,"onUpdate:modelValue":s[5]||(s[5]=t=>e.serialAndMac.macAddress=t),filled:"",label:"ONU Mac Address",readonly:""},null,8,["modelValue"]),a(U,{outlined:"",modelValue:e.oltIp,"onUpdate:modelValue":s[6]||(s[6]=t=>e.oltIp=t),options:V,label:"OLT","emit-value":"","map-options":""},null,8,["modelValue"]),a(J,{align:"right"},{default:d(()=>[a(A,{flat:"",label:"OK",color:"primary",onClick:v}),a(A,{flat:"",label:"close",color:"primary",onClick:_})]),_:1})]),_:1}),a(j,{class:"bg-primary text-white"},{default:d(()=>[M(" Response: "+S(f.value),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});var Me=F(ye,[["__scopeId","data-v-3a487782"]]);const he=O({__name:"InetConfig",setup(p){const u=z(),r=c(),_=c([]),V=c(""),f=u.$state.subscribercolumns,e=c(!1);let v=[];const w=c({id:0,accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuDeviceName:"",onuMacAddress:"",packageTypeId:""}),g=async t=>{e.value=!e.value,v=(await ue()).map(o=>({serial_number:o.serial_number,mac_address:o.mac_address})),w.value=await re(t)},n=()=>{e.value=!e.value},s=async()=>{_.value=[],_.value=await h()};return P(async()=>{_.value=await h()}),(t,m)=>(T(),x(Q,{padding:""},{default:d(()=>[a(le,{rows:_.value,title:"For Provision","row-key":"name",columns:C(f),loading:!(_.value.length>0),pagination:{rowsPerPage:10},dense:t.$q.screen.lt.md},{"body-cell-actions":d(o=>[a(ee,{props:o},{default:d(()=>[a(A,{dense:"",round:"",flat:"",icon:"assignment",onClick:I=>g(o.row.id)},null,8,["onClick"]),a(A,{dense:"",round:"",flat:"",icon:"build",onClick:I=>g(o.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),"top-right":d(()=>[a(A,{icon:"autorenew",class:"cursor-pointer q-mx-sm",onClick:s,flat:""}),a(b,{modelValue:V.value,"onUpdate:modelValue":m[0]||(m[0]=o=>V.value=o),filled:"",dense:"",label:"Search",debounce:"300",color:"primary"},{append:d(()=>[a(D,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","loading","dense"]),a(Me,{"is-open":e.value,onOpenModal:g,"serial-and-mac":C(v),client:w.value,"close-modal":n},null,8,["is-open","serial-and-mac","client"]),a(Ne,{"data-id":r.value,"get-subsribers":s},null,8,["data-id"])]),_:1}))}});export{he as default};
