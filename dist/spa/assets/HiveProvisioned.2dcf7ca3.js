import{Q as U,a as B,c as te,f as oe,K as le,L as se,M as ne}from"./hiveConnect.e93c26d4.js";import{X as q,r as n,af as ie,V,w as ue,Y as C,Z as k,_ as t,$ as a,ah as o,a1 as m,a2 as s,an as O,a5 as H,a0 as j,ai as A,as as re,a3 as R,aj as ce,ak as de,o as me,Q as x}from"./index.02e8a7e6.js";import{Q as pe,a as ve}from"./QInput.0a37f1e3.js";import{a as fe,u as _e,Q as be}from"./use-quasar.3a466a15.js";import{a as ge}from"./QTable.cec1085a.js";import{Q as he}from"./QAjaxBar.e281b845.js";import{Q as D}from"./QBanner.6fb5c4ca.js";import{Q as T,a as P}from"./QCard.e731b44d.js";import{Q as we}from"./QCardActions.691f255e.js";import{a as $}from"./axios.66c02ff4.js";import"./QItem.45c54daf.js";import"./QList.a1c41ad5.js";const Ne=_=>(ce("data-v-05a26dca"),_=_(),de(),_),ye={class:"provision-info"},Ie=Ne(()=>o("br",null,null,-1)),Se=["src"],Te=q({__name:"TroubleshootClient",props:{confirm:{type:Boolean},closeModal:{type:Function},deviceName:{},clientId:{}},setup(_){const I=fe(),p=_,b=n(!1),{confirm:i}=ie(p),y=()=>{p.closeModal()},u=n({__name__:"",device_name:"",device_role:"",instance:"",job:"",site_name:"",site_status:"",site_tenant:"",olt_ip:""}),r=n("2d"),v=n(""),f=n(""),e=V({accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuMacAddress:"",onuDeviceName:"",packageTypeId:"",oltSite:"",oltInterface:""}),g=V({upStream:"",downStream:""}),S=[{label:"Last 5 minutes",value:"5m"},{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 3 hours",value:"3h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 2 days",value:"2d"},{label:"Last 90 days",value:"90d"}],h=()=>{I.notify({message:"Gathering SNMP Data! Please wait for a moment.",color:"warning",position:"top"})},c=async(w,N)=>{console.log(w),I.loading.show();try{if(!w){l();return}const d=await $.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${w}"}`);u.value=d.data.data.result[0].metric,v.value=d.data.data.result[0].value[1];const L=u.value.olt_ip,z=await $.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="OLT-${L}"}`);console.log(L),f.value=z.data.data.result[0].value[1];const{accountNumber:E,clientName:F,ipAssigned:G,onuSerialNumber:K,oltInterface:X,oltIp:Y,onuDeviceName:Z,onuMacAddress:J,packageTypeId:M,ssidName:De,ssidPw:Pe}=await oe(N);e.accountNumber=E,e.clientName=F,e.ipAssigned=G,e.oltIp=Y,e.oltInterface=X,e.onuDeviceName=Z,e.onuMacAddress=J,e.onuSerialNumber=K,e.packageTypeId=M;try{const Q=await le(e.oltIp);e.oltSite=Q.olt_name;const W=await se(M),{upstream:ee,downstream:ae}=W;g.upStream=ee,g.downStream=ae}catch(Q){throw Q}b.value=!0}catch(d){console.log(d),l()}I.loading.hide()},l=()=>{y(),h()};return ue(i,()=>{i.value===!0&&c(p.deviceName,p.clientId)}),(w,N)=>(C(),k(U,null,{default:t(()=>[a(he,{ref:"bar",color:"info",position:"bottom",size:"10px","skip-hijack":""},null,512),a(te,{modelValue:A(i),"onUpdate:modelValue":N[1]||(N[1]=d=>re(i)?i.value=d:null),persistent:"","transition-show":"flip-down","transition-hide":"flip-up"},{default:t(()=>[b.value?(C(),k(T,{key:0,class:"dialog-content"},{default:t(()=>[o("div",ye,[a(T,null,{default:t(()=>[a(D,{class:"bg-primary text-white"},{default:t(()=>[m(" Client Details ")]),_:1}),a(P,null,{default:t(()=>[o("p",null,"Client Name: "+s(e.clientName),1),o("p",null,"Account Number: "+s(e.accountNumber),1),o("p",null,"Package Type: "+s(e.packageTypeId),1)]),_:1})]),_:1}),a(T,null,{default:t(()=>[a(D,{class:"bg-primary text-white"},{default:t(()=>[m(" ONU Details ")]),_:1}),a(P,null,{default:t(()=>[o("p",null,[m(" ONU Status: "),o("span",{style:O(v.value==="1"?"color: green":"color: red")},s(v.value==="1"?"UP":"Down"),5)]),o("p",null,"ONU IP: "+s(e.ipAssigned),1),o("p",null,"ONU Serial Number: "+s(e.onuSerialNumber),1),o("p",null,"ONU Mac Address: "+s(e.onuMacAddress),1),o("p",null,[m(" upstream: "+s(g.upStream)+" kbps ",1),Ie,m(" downstream: "+s(g.downStream)+" kbps ",1)])]),_:1})]),_:1}),a(T,null,{default:t(()=>[a(D,{class:"bg-primary text-white"},{default:t(()=>[m(" OLT Details ")]),_:1}),a(P,null,{default:t(()=>[o("p",null,[m(" OLT Status: "),o("span",{style:O(f.value==="1"?"color: green":"color: red")},s(f.value==="1"?"UP":"Down"),5)]),o("p",null," OLT IP: "+s(e.oltIp),1),o("p",null,"OLT Site: "+s(e.oltSite),1),o("p",null,"OLT Interface: "+s(e.oltInterface),1)]),_:1})]),_:1})]),a(B,{modelValue:r.value,"onUpdate:modelValue":N[0]||(N[0]=d=>r.value=d),options:S,label:"Select Time",filled:"",class:"select-time q-py-md","emit-value":"","map-options":""},null,8,["modelValue"]),o("iframe",{src:`http://172.91.10.151:3000/d-solo/d94d1e0e-a6e4-45c4-847f-6603e1c31ccb/subscribers-traffic-rate-and-uptime?orgId=1&from=now-${r.value}&to=now&var-Subscriber=${w.deviceName}&panelId=3`,class:"grafana-panel",frameborder:"0"},null,8,Se),a(we,{vertical:"",align:"right"},{default:t(()=>[a(H,{filled:"",label:"Close",color:"red",onClick:y})]),_:1})]),_:1})):j("",!0)]),_:1},8,["modelValue"])]),_:1}))}});var Ce=R(Te,[["__scopeId","data-v-05a26dca"]]);const ke={class:"table-top-right"},Qe=q({__name:"HiveProvisioned",setup(_){const p=_e().$state.subscribercolumns,b=n([]),i=n(""),y=n(0),u=n(!1),r=n(""),v=n(["accountNumber","clientName","ipAssigned","onuSerialNumber","onuMacAddress","oltIp","packageTypeId","ssidName","actions"]),f=n(!1),e=(h,c)=>{i.value=h,y.value=c,u.value=!u.value},g=()=>{u.value=!u.value};me(async()=>{await S()});const S=async()=>{r.value="",f.value=!0,b.value=[],b.value=await ne(),f.value=!1};return(h,c)=>(C(),k(U,{padding:""},{default:t(()=>[a(ge,{class:"my-sticky-last-column-table",title:"Hive Connect Provisioned","row-key":"name",columns:A(p),rows:b.value,loading:f.value,pagination:{rowsPerPage:10},dense:h.$q.screen.lt.md,filter:r.value,"visible-columns":v.value},{"top-right":t(()=>[o("div",ke,[a(B,{modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=l=>v.value=l),multiple:"",outlined:"",dense:"","options-dense":"","display-value":h.$q.lang.table.columns,"emit-value":"","map-options":"",options:A(p),"option-value":"name","options-cover":"",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"]),a(pe,{modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=l=>r.value=l),filled:"",dense:"",label:"Search",debounce:"300",color:"primary",clearable:""},{append:t(()=>[a(x,{name:"search"})]),_:1},8,["modelValue"]),a(x,{name:"autorenew",class:"cursor-pointer q-ma-sm",size:"sm",onClick:S,flat:""})])]),"body-cell-actions":t(l=>[a(ve,{props:l},{default:t(()=>[a(H,{dense:"",round:"",flat:"",icon:"build",onClick:w=>e(l.row.onuDeviceName+"-"+l.row.ipAssigned,l.row.id),disable:l.row.onuDeviceName===null||l.row.onuDeviceName===""},{default:t(()=>[l.row.onuDeviceName===null||l.row.onuDeviceName===""?(C(),k(be,{key:0,anchor:"center left",self:"center right",offset:[10,10]},{default:t(()=>[m(" Device Name Missing! ")]),_:1})):j("",!0)]),_:2},1032,["onClick","disable"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","dense","filter","visible-columns"]),a(Ce,{confirm:u.value,"close-modal":g,"device-name":i.value,clientId:y.value},null,8,["confirm","device-name","clientId"])]),_:1}))}});var Re=R(Qe,[["__scopeId","data-v-52902278"]]);export{Re as default};
