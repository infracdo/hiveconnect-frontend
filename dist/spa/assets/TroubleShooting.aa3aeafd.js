import{Q as L,a as N}from"./QBanner.d87c95c4.js";import{w as J,Q as x,i as K,j as W,k as R,l as ee}from"./networkAddressAPIs.bd56f447.js";import{a3 as ae,X as te,r as u,V as O,o as se,Y as d,Z as le,_ as n,$ as l,ai as a,a5 as oe,a6 as _,a1 as r,a2 as o,at as A,a0 as v}from"./index.9def1f94.js";import{a as S,Q as g}from"./QCard.0a60a028.js";import{Q as ne}from"./QPage.b6fd3be6.js";import{a as Q}from"./axios.66c02ff4.js";import"./QItem.318f7b97.js";const ue={class:"select"},ie={key:0,class:"my-cards"},re={class:""},ce={class:""},de={style:{}},pe={class:""},me={class:""},_e={style:{}},ve={class:"grafana-main"},be={key:0,class:"grafana"},fe=["src"],he=te({__name:"TroubleShooting",setup(ye){const i=u({label:"",id:0}),w=u(),b=u(!1),p=u(""),I=u([]),f=u({__name__:"",device_name:"",device_role:"",instance:"",job:"",site_name:"",site_status:"",site_tenant:""}),h=u(""),y=u(""),V=[{label:"Last 5 minutes",value:"5m"},{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 3 hours",value:"3h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 2 days",value:"2d"},{label:"Last 90 days",value:"90d"}],e=O({accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuMacAddress:"",onuDeviceName:"",packageTypeId:"",oltSite:"",oltInterface:""}),m=O({upStream:"",downStream:""}),k=async()=>{const c=await J();I.value=c.filter(t=>t.onuDeviceName!==null&&t.onuDeviceName.trim()!=="").map(t=>({onuDeviceName:t.onuDeviceName,id:t.id}))},B=async(c,t)=>{const s=w.value;s==null||s.start();const T=await Q.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${c}"}`);f.value=T.data.data.result[0].metric,h.value=T.data.data.result[0].value[1];const P=await Q.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${f.value.site_name}"}`);y.value=P.data.data.result[0].value[1];const U=await K(t),{accountNumber:j,clientName:M,ipAssigned:$,oltIp:C,onuDeviceName:q,onuMacAddress:E,onuSerialNumber:z,packageTypeId:D}=U;e.accountNumber=j,e.clientName=M,e.ipAssigned=$,e.oltIp=C,e.onuDeviceName=q,e.onuMacAddress=E,e.onuSerialNumber=z,e.packageTypeId=D;const H=await W(C),{olt_site:X}=H;e.oltSite=X;const Y=await R(D),{upstream:Z,downstream:F}=Y;m.upStream=Z,m.downStream=F;const G=await ee(c);e.oltInterface=G,s==null||s.stop(),b.value=!0};return se(()=>{k()}),(c,t)=>(d(),le(ne,{padding:""},{default:n(()=>[l(L,{color:"secondary",position:"bottom"}),a("div",ue,[l(x,{modelValue:i.value,"onUpdate:modelValue":[t[0]||(t[0]=s=>i.value=s),t[1]||(t[1]=s=>B(i.value.label,i.value.id))],options:I.value.map(s=>({label:s.onuDeviceName,id:s.id})),label:"Select Subscriber",filled:"",class:"select-subscriber","map-option":""},null,8,["modelValue","options"]),l(x,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=s=>p.value=s),options:V,label:"Select Time",filled:"",class:"select-subscriber","emit-value":"","map-options":""},null,8,["modelValue"]),l(oe,{icon:"autorenew",class:"cursor-pointer q-mx-sm",onClick:k,flat:""})]),l(L,{ref_key:"bar",ref:w,color:"info",position:"bottom",size:"10px","skip-hijack":""},null,512),b.value?(d(),_("div",ie,[l(g,null,{default:n(()=>[l(N,{class:"bg-primary text-white"},{default:n(()=>[r(" Client Details ")]),_:1}),l(S,null,{default:n(()=>[a("p",null,"Client Name: "+o(e.clientName),1),a("p",null,"Account Number: "+o(e.accountNumber),1),a("p",null,"Package Type: "+o(e.packageTypeId),1)]),_:1})]),_:1}),l(g,null,{default:n(()=>[l(N,{class:"bg-primary text-white"},{default:n(()=>[r(" ONU Details ")]),_:1}),l(S,null,{default:n(()=>[a("p",re,[r(" ONU Status: "),i.value.label!==""?(d(),_("span",{key:0,class:A(h.value==="1"?"up":"down")},o(h.value==="1"?"UP":"Down"),3)):v("",!0)]),a("p",ce,[r(" ONU IP: "),a("span",de,o(f.value.instance),1)]),a("p",null,"ONU Serial Number: "+o(e.onuSerialNumber),1),a("p",null,"ONU Mac Address: "+o(e.onuMacAddress),1),a("p",null," upstream: "+o(m.upStream)+" downstream: "+o(m.downStream),1)]),_:1})]),_:1}),l(g,null,{default:n(()=>[l(N,{class:"bg-primary text-white"},{default:n(()=>[r(" OLT Details ")]),_:1}),l(S,null,{default:n(()=>[a("p",pe,[r(" OLT Status: "),i.value.label!==""?(d(),_("span",{key:0,class:A(y.value==="1"?"up":"down")},o(y.value==="1"?"UP":"Down"),3)):v("",!0)]),a("p",me,[r(" OLT IP: "),a("span",_e,o(e.oltIp),1)]),a("p",null,"OLT Site: "+o(e.oltSite),1),a("p",null,"OLT Interface: "+o(e.oltInterface),1)]),_:1})]),_:1})])):v("",!0),a("div",ve,[b.value&&p.value!==""?(d(),_("div",be,[a("div",null,[a("iframe",{src:`http://172.91.10.151:3000/d-solo/d94d1e0e-a6e4-45c4-847f-6603e1c31ccb/subscribers-traffic-rate-and-uptime?orgId=1&from=now-${p.value}&to=now&var-Subscriber=${i.value.label}&panelId=3`,class:"grafana-panel",frameborder:"0"},null,8,fe)])])):v("",!0)])]),_:1}))}});var Ce=ae(he,[["__scopeId","data-v-c8f881fe"]]);export{Ce as default};
