import{Q as D,a as S}from"./QBanner.6e89a9d6.js";import{Q as G,h as x}from"./QPage.e32bfed6.js";import{$ as J,T as K,r as u,P as O,o as R,U as d,V as ee,W as n,X as s,ah as a,a1 as ae,a2 as _,Z as c,_ as l,aM as A,Y as v}from"./index.7f9642e6.js";import{a as N,Q as g}from"./QCard.15b982ce.js";import{f as te,g as se,c as le,a as oe,b as ne}from"./networkAddressAPIs.51c2ee3b.js";import{a as P}from"./axios.a596eead.js";import"./QItem.087f6bb9.js";const ue={class:"select"},ie={key:0,class:"my-cards"},ce={class:""},re={class:""},de={style:{}},pe={class:""},me={class:""},_e={style:{}},ve={class:"grafana-main"},be={key:0,class:"grafana"},fe=["src"],he=K({__name:"TroubleShooting",setup(ye){const i=u({label:"",id:0}),w=u(),b=u(!1),p=u(""),I=u([]),f=u({__name__:"",device_name:"",device_role:"",instance:"",job:"",site_name:"",site_status:"",site_tenant:""}),h=u(""),y=u(""),V=[{label:"Last 5 minutes",value:"5m"},{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 3 hours",value:"3h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 2 days",value:"2d"},{label:"Last 90 days",value:"90d"}],e=O({accountNumber:"",clientName:"",ipAssigned:"",onuSerialNumber:"",oltIp:"",onuMacAddress:"",onuDeviceName:"",packageTypeId:"",oltSite:"",oltInterface:""}),m=O({upStream:"",downStream:""}),k=async()=>{const r=await te();I.value=r.map(o=>({onuDeviceName:o.onuDeviceName,id:o.id}))},B=async(r,o)=>{const t=w.value;t==null||t.start();const T=await P.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${r}"}`);f.value=T.data.data.result[0].metric,h.value=T.data.data.result[0].value[1];const Q=await P.get(`http://172.91.10.129:9090/api/v1/query?query=lo_status{job=%22ip_address%22,site_tenant=%22DCTECH%22,device_name="${f.value.site_name}"}`);y.value=Q.data.data.result[0].value[1];const U=await se(o),{accountNumber:M,clientName:$,ipAssigned:j,oltIp:C,onuDeviceName:q,onuMacAddress:E,onuSerialNumber:z,packageTypeId:L}=U;e.accountNumber=M,e.clientName=$,e.ipAssigned=j,e.oltIp=C,e.onuDeviceName=q,e.onuMacAddress=E,e.onuSerialNumber=z,e.packageTypeId=L;const H=await le(C),{olt_site:W}=H;e.oltSite=W;const X=await oe(L),{upstream:Y,downstream:Z}=X;m.upStream=Y,m.downStream=Z;const F=await ne(r);e.oltInterface=F,t==null||t.stop(),b.value=!0};return R(()=>{k()}),(r,o)=>(d(),ee(G,{padding:""},{default:n(()=>[s(D,{color:"secondary",position:"bottom"}),a("div",ue,[s(x,{modelValue:i.value,"onUpdate:modelValue":[o[0]||(o[0]=t=>i.value=t),o[1]||(o[1]=t=>B(i.value.label,i.value.id))],options:I.value.map(t=>({label:t.onuDeviceName,id:t.id})),label:"Select Subscriber",filled:"",class:"select-subscriber","map-option":""},null,8,["modelValue","options"]),s(x,{modelValue:p.value,"onUpdate:modelValue":o[2]||(o[2]=t=>p.value=t),options:V,label:"Select Time",filled:"",class:"select-subscriber","emit-value":"","map-options":""},null,8,["modelValue"]),s(ae,{icon:"autorenew",class:"cursor-pointer q-mx-sm",onClick:k,flat:""})]),s(D,{ref_key:"bar",ref:w,color:"info",position:"bottom",size:"10px","skip-hijack":""},null,512),b.value?(d(),_("div",ie,[s(g,null,{default:n(()=>[s(S,{class:"bg-primary text-white"},{default:n(()=>[c(" Client Details ")]),_:1}),s(N,null,{default:n(()=>[a("p",null,"Client Name: "+l(e.clientName),1),a("p",null,"Account Number: "+l(e.accountNumber),1),a("p",null,"Package Type: "+l(e.packageTypeId),1)]),_:1})]),_:1}),s(g,null,{default:n(()=>[s(S,{class:"bg-primary text-white"},{default:n(()=>[c(" ONU Details ")]),_:1}),s(N,null,{default:n(()=>[a("p",ce,[c(" ONU Status: "),i.value.label!==""?(d(),_("span",{key:0,class:A(h.value==="1"?"up":"down")},l(h.value==="1"?"UP":"Down"),3)):v("",!0)]),a("p",re,[c(" ONU IP: "),a("span",de,l(f.value.instance),1)]),a("p",null,"ONU Serial Number: "+l(e.onuSerialNumber),1),a("p",null,"ONU Mac Address: "+l(e.onuMacAddress),1),a("p",null," upstream: "+l(m.upStream)+" downstream: "+l(m.downStream),1)]),_:1})]),_:1}),s(g,null,{default:n(()=>[s(S,{class:"bg-primary text-white"},{default:n(()=>[c(" OLT Details ")]),_:1}),s(N,null,{default:n(()=>[a("p",pe,[c(" OLT Status: "),i.value.label!==""?(d(),_("span",{key:0,class:A(y.value==="1"?"up":"down")},l(y.value==="1"?"UP":"Down"),3)):v("",!0)]),a("p",me,[c(" OLT IP: "),a("span",_e,l(e.oltIp),1)]),a("p",null,"OLT Site: "+l(e.oltSite),1),a("p",null,"OLT Interface: "+l(e.oltInterface),1)]),_:1})]),_:1})])):v("",!0),a("div",ve,[b.value&&p.value!==""?(d(),_("div",be,[a("div",null,[a("iframe",{src:`http://172.91.10.151:3000/d-solo/d94d1e0e-a6e4-45c4-847f-6603e1c31ccb/subscribers-traffic-rate-and-uptime?orgId=1&from=now-${p.value}&to=now&var-Subscriber=${i.value.label}&panelId=3`,class:"grafana-panel",frameborder:"0"},null,8,fe)])])):v("",!0)])]),_:1}))}});var Ce=J(he,[["__scopeId","data-v-fe0bb30a"]]);export{Ce as default};
